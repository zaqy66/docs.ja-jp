---
title: .NET Framework 4 への移行に関する問題
ms.date: 05/02/2017
helpviewer_keywords:
- .NET Framework 4, migration
- application compatibility
ms.assetid: df478548-8c05-4de2-8ba7-adcdbe1c2a60
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 35cac6c93594847f5118849a14c4c5f991601367
ms.sourcegitcommit: 30e2fe5cc4165aa6dde7218ec80a13def3255e98
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/13/2019
ms.locfileid: "56221317"
---
# <a name="net-framework-4-migration-issues"></a><span data-ttu-id="028db-102">.NET Framework 4 への移行に関する問題</span><span class="sxs-lookup"><span data-stu-id="028db-102">.NET Framework 4 migration issues</span></span>

<span data-ttu-id="028db-103">このトピックでは、.NET Framework バージョン 3.5 Service Pack 1 から .NET Framework バージョン 4 への移行に関する問題、修正、標準への準拠やセキュリティに関する変更、お客様のフィードバックに基づいた変更などについて説明します。</span><span class="sxs-lookup"><span data-stu-id="028db-103">This topic describes migration issues between the .NET Framework version 3.5 Service Pack 1 and the .NET Framework version 4, including fixes, changes for standards compliance and security, and changes based on customer feedback.</span></span> <span data-ttu-id="028db-104">これらの変更点のほとんどは、アプリケーションのプログラミング変更を必要としません。</span><span class="sxs-lookup"><span data-stu-id="028db-104">Most of these changes do not require any programming modifications in your applications.</span></span> <span data-ttu-id="028db-105">変更が必要になる可能性のある変更点については、表の「推奨される変更」列をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-105">For those that may involve modifications, see the Recommended changes column of the table.</span></span>

<span data-ttu-id="028db-106">このトピックでは、次の分野の主な変更点について説明します。</span><span class="sxs-lookup"><span data-stu-id="028db-106">This topic describes notable changes in the following areas:</span></span>

* [<span data-ttu-id="028db-107">ASP.NET と Web</span><span class="sxs-lookup"><span data-stu-id="028db-107">ASP.NET and Web</span></span>](#aspnet-and-web)

* [<span data-ttu-id="028db-108">コア</span><span class="sxs-lookup"><span data-stu-id="028db-108">Core</span></span>](#core)

* [<span data-ttu-id="028db-109">データ</span><span class="sxs-lookup"><span data-stu-id="028db-109">Data</span></span>](#data)

* [<span data-ttu-id="028db-110">Windows Communication Foundation (WCF)</span><span class="sxs-lookup"><span data-stu-id="028db-110">Windows Communication Foundation (WCF)</span></span>](#windows-communication-foundation-wcf)

* [<span data-ttu-id="028db-111">Windows Presentation Foundation (WPF)</span><span class="sxs-lookup"><span data-stu-id="028db-111">Windows Presentation Foundation (WPF)</span></span>](#windows-presentation-foundation-wpf)

* [<span data-ttu-id="028db-112">XML</span><span class="sxs-lookup"><span data-stu-id="028db-112">XML</span></span>](#xml)

<span data-ttu-id="028db-113">このトピックで取り上げる問題の大まかな概要については、「[.NET Framework 4 移行ガイド](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff657133%28v=vs.100%29)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-113">For an higher-level overview of the issues in this topic, see the [Migration Guide to the .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff657133%28v=vs.100%29).</span></span>

<span data-ttu-id="028db-114">新しい機能については、「[.NET Framework 4 の新機能](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms171868%28v=vs.100%29)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-114">For information about new features, see [What's New in the .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms171868%28v=vs.100%29).</span></span>

## <a name="aspnet-and-web"></a><span data-ttu-id="028db-115">ASP.NET と Web</span><span class="sxs-lookup"><span data-stu-id="028db-115">ASP.NET and Web</span></span>

<span data-ttu-id="028db-116">名前空間: <xref:System.Web>、<xref:System.Web.Mobile>、<xref:System.Web.Security>、<xref:System.Web.UI.WebControls>。アセンブリ: System.Web (System.Web.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-116">Namespaces: <xref:System.Web>, <xref:System.Web.Mobile>, <xref:System.Web.Security>, <xref:System.Web.UI.WebControls>; assembly: System.Web (in System.Web.dll)</span></span>

| <span data-ttu-id="028db-117">機能</span><span class="sxs-lookup"><span data-stu-id="028db-117">Feature</span></span> | <span data-ttu-id="028db-118">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-118">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-119">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-119">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-120">**ブラウザー定義ファイル**</span><span class="sxs-lookup"><span data-stu-id="028db-120">**Browser definition files**</span></span> | <span data-ttu-id="028db-121">ブラウザー定義ファイルは、新しいブラウザーとデバイスや、更新されたブラウザーとデバイスに関する情報を含むように、更新されました。</span><span class="sxs-lookup"><span data-stu-id="028db-121">The browser definition files have been updated to include information about new and updated browsers and devices.</span></span> <span data-ttu-id="028db-122">Netscape Navigator などの古いブラウザーとデバイスは削除され、Google Chrome や Apple iPhone などの新しいブラウザーとデバイスが追加されました。</span><span class="sxs-lookup"><span data-stu-id="028db-122">Older browsers and devices such as Netscape Navigator have been removed, and newer browsers and devices such as Google Chrome and Apple iPhone have been added.</span></span><br><br><span data-ttu-id="028db-123">削除されたブラウザー定義の 1 つを継承するカスタム ブラウザー定義がご利用のアプリケーションに含まれている場合は、エラーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="028db-123">If your application contains custom browser definitions that inherit from one of the browser definitions that have been removed, you will see an error.</span></span><br><br><span data-ttu-id="028db-124"><xref:System.Web.HttpBrowserCapabilities> オブジェクト (ページの `Request.Browse` プロパティで公開されます) は、ブラウザー定義ファイルによって実行されます。</span><span class="sxs-lookup"><span data-stu-id="028db-124">The <xref:System.Web.HttpBrowserCapabilities> object (which is exposed by the page's `Request.Browse` property) is driven by the browser definition files.</span></span> <span data-ttu-id="028db-125">そのため、ASP.NET 4 でこのオブジェクトのプロパティにアクセスすることで返される情報は、旧バージョンの ASP.NET で返された情報とは異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="028db-125">Therefore, the information that is returned by accessing a property of this object in ASP.NET 4 might be different than the information that was returned in an earlier version of ASP.NET.</span></span> | <span data-ttu-id="028db-126">ご利用のアプリケーションが古いブラウザー定義ファイルに依存している場合は、次のフォルダーからそれらのファイルをコピーできます。</span><span class="sxs-lookup"><span data-stu-id="028db-126">If your application relies on the old browser definition files, you can copy them from the following folder:</span></span><br><br><span data-ttu-id="028db-127">*Windows\\Microsoft.NET\\Framework\\v2.0.50727\\CONFIG\\Browsers*</span><span class="sxs-lookup"><span data-stu-id="028db-127">*Windows\\Microsoft.NET\\Framework\\v2.0.50727\\CONFIG\\Browsers*</span></span><br><br><span data-ttu-id="028db-128">ASP.NET 4 の対応する *\\CONFIG\\Browsers* フォルダーにファイルをコピーします。</span><span class="sxs-lookup"><span data-stu-id="028db-128">Copy the files into the corresponding *\\CONFIG\\Browsers* folder for ASP.NET 4.</span></span> <span data-ttu-id="028db-129">ファイルをコピーしたら、[Aspnet_regbrowsers.exe](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms229858(v=vs.90)) コマンドライン ツールを実行します。</span><span class="sxs-lookup"><span data-stu-id="028db-129">After you copy the files, run the [Aspnet_regbrowsers.exe](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms229858(v=vs.90)) command-line tool.</span></span> <span data-ttu-id="028db-130">詳細については、Web サイト [https://www.asp.net/mobile](/aspnet/mobile/overview) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="028db-130">For more information, see the [https://www.asp.net/mobile](/aspnet/mobile/overview) Web site.</span></span> |
| <span data-ttu-id="028db-131">**ASP.NET の複数のバージョンが混在する環境で実行される子アプリケーション**</span><span class="sxs-lookup"><span data-stu-id="028db-131">**Child applications running under mixed versions of ASP.NET**</span></span> | <span data-ttu-id="028db-132">旧バージョンの ASP.NET を実行する子アプリケーションとして構成されている ASP.NET 4 アプリケーションは、構成エラーまたはコンパイル エラーにより起動しない場合があります。</span><span class="sxs-lookup"><span data-stu-id="028db-132">ASP.NET 4 applications that are configured as children of applications that run earlier versions of ASP.NET might fail to start because of configuration or compilation errors.</span></span> <span data-ttu-id="028db-133">実際に発生するエラーは、アプリケーションが実行される IIS のバージョン (6.0、7、または 7.5) によって異なります。</span><span class="sxs-lookup"><span data-stu-id="028db-133">The specific error that occurs depends on whether the application runs under IIS 6.0, or under IIS 7 or IIS 7.5.</span></span> | <span data-ttu-id="028db-134">影響を受けるアプリケーションの構成ファイルを変更することで、構成システムが ASP.NET 4 アプリケーションを適切に認識するように設定できます。</span><span class="sxs-lookup"><span data-stu-id="028db-134">You can make changes to the configuration files of the affected applications so that the configuration system correctly recognizes the ASP.NET 4 application.</span></span> <span data-ttu-id="028db-135">実行する必要がある変更については、ASP.NET Web サイトの「[ASP.NET 4 Breaking Changes (ASP.NET 4 の互換性に影響する変更点)](/aspnet/whitepapers/aspnet4/breaking-changes)」の「ASP.NET 4 Child Applications Fail to Start When Under ASP.NET 2.0 or ASP.NET 3.5 Applications (ASP.NET 2.0 または ASP.NET 3.5 アプリケーションで ASP.NET 4 の子アプリケーションが起動しない)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-135">For information about the changes you must make, see the section "ASP.NET 4 Child Applications Fail to Start When Under ASP.NET 2.0 or ASP.NET 3.5 Applications" in the document [ASP.NET 4 Breaking Changes](/aspnet/whitepapers/aspnet4/breaking-changes) on the ASP.NET Web site.</span></span> |
| <span data-ttu-id="028db-136">**ClientID の変更**</span><span class="sxs-lookup"><span data-stu-id="028db-136">**ClientID changes**</span></span> | <span data-ttu-id="028db-137">ASP.NET 4 の新しい `clientIDMode` 設定では、ASP.NET が HTML 要素の `id` 属性を生成する方法を指定できます。</span><span class="sxs-lookup"><span data-stu-id="028db-137">The new `clientIDMode` setting in ASP.NET 4 lets you specify how ASP.NET generates the `id` attribute for HTML elements.</span></span> <span data-ttu-id="028db-138">以前のバージョンの ASP.NET では、既定の動作は `clientIDMode` の `AutoID` 設定と同じでした。</span><span class="sxs-lookup"><span data-stu-id="028db-138">In previous versions of ASP.NET, the default behavior was equivalent to the `AutoID` setting of `clientIDMode`.</span></span> <span data-ttu-id="028db-139">現在の既定の設定は `Predictable` です。</span><span class="sxs-lookup"><span data-stu-id="028db-139">The default setting is now `Predictable`.</span></span> <span data-ttu-id="028db-140">詳細については、[ASP.NET Web サーバー コントロールの識別](https://docs.microsoft.com/previous-versions/aspnet/1d04y8ss%28v=vs.100%29)に関する記事をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-140">For more information, see [ASP.NET Web Server Control Identification](https://docs.microsoft.com/previous-versions/aspnet/1d04y8ss%28v=vs.100%29).</span></span> | <span data-ttu-id="028db-141">Visual Studio を使用して ASP.NET 2.0 または ASP.NET 3.5 からアプリケーションをアップグレードする場合は、旧バージョンの .NET Framework の動作を維持する設定が、ツールによって Web.config ファイルに自動的に追加されます。</span><span class="sxs-lookup"><span data-stu-id="028db-141">If you use Visual Studio to upgrade your application from ASP.NET 2.0 or ASP.NET 3.5, the tool automatically adds a setting to the Web.config file that preserves the behavior of earlier versions of the .NET Framework.</span></span> <span data-ttu-id="028db-142">ただし、IIS のアプリケーション プールを変更して .NET Framework 4 をターゲットにするようにアプリケーションをアップグレードする場合、ASP.NET では新しいモードが既定で使用されます。</span><span class="sxs-lookup"><span data-stu-id="028db-142">However, if you upgrade an application by changing the application pool in IIS to target the .NET Framework 4, ASP.NET uses the new mode by default.</span></span> <span data-ttu-id="028db-143">新しいクライアント ID モードを無効にするには、Web.config ファイルに次の設定を追加します。</span><span class="sxs-lookup"><span data-stu-id="028db-143">To disable the new client ID mode, add the following setting to the Web.config file:</span></span><br><br>`<pages clientIDMode="AutoID" />` |
| <span data-ttu-id="028db-144">**コード アクセス セキュリティ (CAS)**</span><span class="sxs-lookup"><span data-stu-id="028db-144">**Code access security (CAS)**</span></span> | <span data-ttu-id="028db-145">ASP.NET 3.5 で追加された ASP.NET 2.0 NET 機能は、.NET Framework 1.1 と .NET Framework 2.0 のコード アクセス セキュリティ (CAS) モデルを使用します。</span><span class="sxs-lookup"><span data-stu-id="028db-145">ASP.NET 2.0 NET features that were added in ASP.NET 3.5 use the .NET Framework 1.1 and .NET Framework 2.0 code access security (CAS) model.</span></span> <span data-ttu-id="028db-146">ただし、ASP.NET 4 での CAS の実装は大幅に見直されました。</span><span class="sxs-lookup"><span data-stu-id="028db-146">However, the implementation of CAS in ASP.NET 4 has been substantially overhauled.</span></span> <span data-ttu-id="028db-147">その結果、グローバル アセンブリ キャッシュで実行されている信頼されるコードに依存する、部分的に信頼された ASP.NET アプリケーションの実行は、さまざまなセキュリティ例外で失敗することがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-147">As a result, partial-trust ASP.NET applications that rely on trusted code running in the global assembly cache might fail with various security exceptions.</span></span> <span data-ttu-id="028db-148">マシンの CAS ポリシーに対する広範な変更に依存する、部分的に信頼されたアプリケーションも、失敗してセキュリティ例外をスローすることがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-148">Partial-trust applications that rely on extensive modifications to machine CAS policy might also fail and throw security exceptions.</span></span> | <span data-ttu-id="028db-149">次の例に示すように、`trust` 構成要素の新しい `legacyCasModel` 属性を使用して、部分的に信頼された ASP.NET 4 アプリケーションを ASP.NET 1.1 および 2.0 の動作に戻すことができます。</span><span class="sxs-lookup"><span data-stu-id="028db-149">You can revert partial-trust ASP.NET 4 applications to the behavior of ASP.NET 1.1 and 2.0 by using the new `legacyCasModel` attribute in the `trust` configuration element, as shown in the following example:</span></span><br><br>`<trust level= "Medium" legacyCasModel="true" />`<br><br><span data-ttu-id="028db-150">重要 : より古い CAS モデルに戻すと、セキュリティが低下する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="028db-150">Important: Reverting to the older CAS model might represent reduced security.</span></span><br><br><span data-ttu-id="028db-151">新しい ASP.NET 4 コード アクセス セキュリティ モデルの詳細については、「[ASP.NET 4 アプリケーションのコード アクセス セキュリティ](https://docs.microsoft.com/previous-versions/dd984947(v=vs.100))」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-151">For more information about the new ASP.NET 4 code access security model, see [Code Access Security in ASP.NET 4 Applications](https://docs.microsoft.com/previous-versions/dd984947(v=vs.100)).</span></span> |
| <span data-ttu-id="028db-152">**構成ファイル**</span><span class="sxs-lookup"><span data-stu-id="028db-152">**Configuration files**</span></span> | <span data-ttu-id="028db-153">.NET Framework と ASP.NET 4 のルート構成ファイル (machine.config ファイルとルート Web.config ファイル) は、ASP.NET 3.5 のアプリケーション Web.config ファイルに記述されていた定型構成情報の大部分を含むように更新されました。</span><span class="sxs-lookup"><span data-stu-id="028db-153">The root configuration files (the machine.config file and the root Web.config file) for the .NET Framework and ASP.NET 4 have been updated to include most of the boilerplate configuration information that was found in the application Web.config files in ASP.NET 3.5.</span></span> <span data-ttu-id="028db-154">マネージド IIS 7 および IIS 7.5 構成システムは複雑であるため、ASP.NET 4 の下で、および IIS 7 と IIS 7.5 の下で ASP.NET 3.5 アプリケーションを実行すると、ASP.NET エラーまたは IIS エラーが発生することがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-154">Because of the complexity of the managed IIS 7 and IIS 7.5 configuration systems, running ASP.NET 3.5 applications under ASP.NET 4 and under IIS 7 and IIS 7.5 can result in either ASP.NET errors or IIS errors.</span></span> | <span data-ttu-id="028db-155">Visual Studio のプロジェクト アップグレード ツールを使用して、ASP.NET 3.5 アプリケーションを ASP.NET 4 にアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="028db-155">Upgrade ASP.NET 3.5 applications to ASP.NET 4 by using the project upgrade tools in Visual Studio.</span></span> <span data-ttu-id="028db-156">Visual Studio 2010 は、ASP.NET 4 の適切な設定を含むように ASP.NET 3.5 アプリケーションの Web.config ファイルを自動的に変更します。</span><span class="sxs-lookup"><span data-stu-id="028db-156">Visual Studio 2010 automatically modifies the ASP.NET 3.5 application's Web.config file to contain the appropriate settings for ASP.NET 4.</span></span><br><br><span data-ttu-id="028db-157">ただし、ASP.NET 3.5 アプリケーションは、再コンパイルしないで .NET Framework 4 を使用して実行できます。</span><span class="sxs-lookup"><span data-stu-id="028db-157">However, you can run ASP.NET 3.5 applications using the .NET Framework 4 without recompilation.</span></span> <span data-ttu-id="028db-158">その場合は、アプリケーションの Web.config ファイルを手動で変更してから、.NET Framework 4 の下で、および IIS 7 または IIS 7.5 の下でアプリケーションの実行が必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="028db-158">In that case, you might have to manually modify the application's Web.config file before you run the application under the .NET Framework 4 and under IIS 7 or IIS 7.5.</span></span> <span data-ttu-id="028db-159">具体的にどのような変更を行う必要があるかについては、Service Pack (SP) リリースなど、使用しているソフトウェアの組み合わせによって異なります。</span><span class="sxs-lookup"><span data-stu-id="028db-159">The specific change you must make depends on the combination of software you are working with, including Service Pack (SP) releases.</span></span> <span data-ttu-id="028db-160">この変更点の影響を受ける可能性のあるソフトウェアの組み合わせと、特定の組み合わせでの問題を解決する方法については、ASP.NET Web サイトの「[ASP.NET 4 Breaking Changes (ASP.NET 4 の互換性に影響する変更点)](/aspnet/whitepapers/aspnet4/breaking-changes)」の「Configuration Errors Related to New ASP.NET 4 Root Configuration (新しい ASP.NET 4 ルート構成に関連する構成エラー)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-160">For information about the possible software combinations that are affected by this change and how to resolve problems with specific combinations, see the section "Configuration Errors Related to New ASP.NET 4 Root Configuration" in the document [ASP.NET 4 Breaking Changes](/aspnet/whitepapers/aspnet4/breaking-changes) on the ASP.NET Web site.</span></span> |
| <span data-ttu-id="028db-161">**コントロールの表示**</span><span class="sxs-lookup"><span data-stu-id="028db-161">**Control rendering**</span></span> | <span data-ttu-id="028db-162">以前のバージョンの ASP.NET では、一部のコントロールで、無効にできないマークアップが生成されていました。</span><span class="sxs-lookup"><span data-stu-id="028db-162">In previous versions of ASP.NET, some controls emitted markup that you could not disable.</span></span> <span data-ttu-id="028db-163">ASP.NET 4 では、この種類のマークアップが既定で生成されなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-163">By default, this type of markup is no longer generated in ASP.NET 4.</span></span> <span data-ttu-id="028db-164">表示に関する変更点は、次のコントロールに影響します。</span><span class="sxs-lookup"><span data-stu-id="028db-164">The rendering changes affect the following controls:</span></span><br><br><span data-ttu-id="028db-165">\* `Image` コントロールと `ImageButton` コントロールでは、`border="0"` 属性は表示されなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-165">\* The `Image` and `ImageButton` controls no longer render a `border="0"` attribute.</span></span><br><span data-ttu-id="028db-166">\* `BaseValidator` クラスとそこから派生する検証コントロールでは、既定で赤いテキストが表示されなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-166">\* The `BaseValidator` class and validation controls that derive from it no longer render red text by default.</span></span><br><span data-ttu-id="028db-167">\* `HtmlForm` コントロールでは、`name` 属性は表示されません。</span><span class="sxs-lookup"><span data-stu-id="028db-167">\* The `HtmlForm` control does not render a `name` attribute.</span></span><br><span data-ttu-id="028db-168">\* `Table` コントロールでは、`border="0"` 属性は表示されなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-168">\* The `Table` control no longer renders a `border="0"` attribute.</span></span><br><br><span data-ttu-id="028db-169">ユーザー入力用にデザインされていないコントロール (たとえば、`Label` コントロール) では、`Enabled` プロパティが `false` に設定されている場合 (または、コンテナー コントロールからこの設定を継承する場合) に `disabled="disabled"` 属性が表示されなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-169">Controls that are not designed for user input (for example, the `Label` control) no longer render the `disabled="disabled"` attribute if their `Enabled` property is set to `false` (or if they inherit this setting from a container control).</span></span> | <span data-ttu-id="028db-170">Visual Studio を使用して ASP.NET 2.0 または ASP.NET 3.5 からアプリケーションをアップグレードする場合は、古い表示を維持する設定が、ツールによって Web.config ファイルに自動的に追加されます。</span><span class="sxs-lookup"><span data-stu-id="028db-170">If you use Visual Studio to upgrade your application from ASP.NET 2.0 or ASP.NET 3.5, the tool automatically adds a setting to the Web.config file that preserves legacy rendering.</span></span> <span data-ttu-id="028db-171">ただし、IIS のアプリケーション プールを変更して .NET Framework 4 をターゲットにするようにアプリケーションをアップグレードする場合、ASP.NET では新しい表示モードが既定で使用されます。</span><span class="sxs-lookup"><span data-stu-id="028db-171">However, if you upgrade an application by changing the application pool in IIS to target the .NET Framework 4, ASP.NET uses the new rendering mode by default.</span></span> <span data-ttu-id="028db-172">新しい表示モードを無効にするには、Web.config ファイルに次の設定を追加します。</span><span class="sxs-lookup"><span data-stu-id="028db-172">To disable the new rendering mode, add the following setting to the Web.config file:</span></span><br><br>`<pages controlRenderingCompatibilityVersion="3.5" />` |
| <span data-ttu-id="028db-173">**既定のドキュメントのイベント ハンドラー**</span><span class="sxs-lookup"><span data-stu-id="028db-173">**Event handlers in default documents**</span></span> | <span data-ttu-id="028db-174">ASP.NET 4 では、既定のドキュメントがマップされている拡張子なしの URL に対して要求が行われた場合に、HTML `form` 要素の `action` 属性の値を空の文字列として表示します。</span><span class="sxs-lookup"><span data-stu-id="028db-174">ASP.NET  4 renders the HTML `form` element's `action` attribute value as an empty string when a request is made to an extensionless URL that has a default document mapped to it.</span></span> <span data-ttu-id="028db-175">旧リリースの ASP.NET では、`http://contoso.com` に対して要求すると Default.aspx に対する要求が生成されました。</span><span class="sxs-lookup"><span data-stu-id="028db-175">In earlier releases of ASP.NET, a request to `http://contoso.com` would result in a request to Default.aspx.</span></span> <span data-ttu-id="028db-176">そのドキュメントでは、`form` 開始タグが次の例のように表示されました。</span><span class="sxs-lookup"><span data-stu-id="028db-176">In that document, the opening `form` tag would be rendered as in the following example:</span></span><br><br>`<form action="Default.aspx" />`<br><br><span data-ttu-id="028db-177">ASP.NET 4 では、`http://contoso.com` に対する要求によって同じく Default.aspx に対する要求が生成されますが、ASP.NET は現在 HTML の `form` 開始タグを次の例のように表示します。</span><span class="sxs-lookup"><span data-stu-id="028db-177">In ASP.NET 4, a request to `http://contoso.com` also results in a request to Default.aspx, but ASP.NET now renders the HTML opening `form` tag as in the following example:</span></span><br><br>`<form action="" />`<br><br><span data-ttu-id="028db-178">`action` 属性が空の文字列の場合、IIS `DefaultDocumentModule` オブジェクトは Default.aspx への子要求を作成します。</span><span class="sxs-lookup"><span data-stu-id="028db-178">When the `action` attribute is an empty string, the IIS `DefaultDocumentModule` object creates a child request to Default.aspx.</span></span> <span data-ttu-id="028db-179">ほとんどの状況では、この子要求はアプリケーション コードに対して透過的であり、Default.aspx ページは正常に実行されます。</span><span class="sxs-lookup"><span data-stu-id="028db-179">Under most conditions, this child request is transparent to application code, and the Default.aspx page runs normally.</span></span> <span data-ttu-id="028db-180">ただし、マネージド コードと IIS 7 または IIS 7.5 統合モードとの間のやり取りによって、マネージド .aspx ページが子要求中に正常に動作を停止することがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-180">However, a potential interaction between managed code and IIS 7 or IIS 7.5 Integrated mode can cause managed .aspx pages to stop working properly during the child request.</span></span> <span data-ttu-id="028db-181">次の状況が発生した場合、既定の .aspx ドキュメントへの子要求は、エラーになるか予期しない動作をします。</span><span class="sxs-lookup"><span data-stu-id="028db-181">If the following conditions occur, the child request to a default .aspx document will result in an error or in unexpected behavior:</span></span><br><br><span data-ttu-id="028db-182">\* `form` 要素の `action` 属性が "" に設定されて .aspx ページがブラウザーに送信された場合。</span><span class="sxs-lookup"><span data-stu-id="028db-182">\* An .aspx page is sent to the browser with the `form` element's `action` attribute set to "".</span></span><br><span data-ttu-id="028db-183">\* フォームが ASP.NET にポストバックされた場合。</span><span class="sxs-lookup"><span data-stu-id="028db-183">\* The form is posted back to ASP.NET.</span></span><br><span data-ttu-id="028db-184">\* マネージド HTTP モジュールが、`Request.Form` や `Request.Params` など、エンティティ本体の一部を読み取った場合。</span><span class="sxs-lookup"><span data-stu-id="028db-184">\* A managed HTTP module reads some part of the entity body, such as `Request.Form` or `Request.Params`.</span></span> <span data-ttu-id="028db-185">これにより、POST 要求のエンティティ本体がマネージド メモリに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="028db-185">This causes the entity body of the POST request to be read into managed memory.</span></span> <span data-ttu-id="028db-186">その結果、エンティティ本体は、IIS 7 または IIS 7.5 統合モードで実行されているネイティブ コード モジュールから使用できなくなります。</span><span class="sxs-lookup"><span data-stu-id="028db-186">As a result, the entity body is no longer available to any native code modules that are running in IIS 7 or IIS 7.5 Integrated mode.</span></span><br><span data-ttu-id="028db-187">\* IIS `DefaultDocumentModule` オブジェクトが最終的に実行され、Default.aspx ドキュメントへの子要求を作成する場合。</span><span class="sxs-lookup"><span data-stu-id="028db-187">\* The IIS `DefaultDocumentModule` object eventually runs and creates a child request to the Default.aspx document.</span></span> <span data-ttu-id="028db-188">ただし、エンティティ本体はマネージド コードの一部によって既に読み取られているため、子要求に対する送信に使用できるエンティティ本体はありません。</span><span class="sxs-lookup"><span data-stu-id="028db-188">However, because the entity body has already been read by a piece of managed code, there is no entity body available to send to the child request.</span></span><br><span data-ttu-id="028db-189">\* HTTP パイプラインが子要求に対して実行されたときに、.aspx ファイルのハンドラーがハンドラー実行フェーズ中に実行された場合。</span><span class="sxs-lookup"><span data-stu-id="028db-189">\* When the HTTP pipeline runs for the child request, the handler for .aspx files runs during the handler-execute phase.</span></span><br><br><span data-ttu-id="028db-190">エンティティ本体はないため、フォーム変数とビュー ステートはありません。</span><span class="sxs-lookup"><span data-stu-id="028db-190">Because there is no entity body, there are no form variables and no view state.</span></span> <span data-ttu-id="028db-191">したがって、.aspx ページ ハンドラーが (イベントが存在する場合) どのイベントを発生させる必要があるかを判断するために使用できる情報がありません。</span><span class="sxs-lookup"><span data-stu-id="028db-191">Therefore there is no information available for the .aspx page handler to determine what event (if any) should be raised.</span></span> <span data-ttu-id="028db-192">その結果、影響を受ける .aspx ページのポストバック イベント ハンドラーは実行されません。</span><span class="sxs-lookup"><span data-stu-id="028db-192">As a result, none of the postback event handlers for the affected .aspx page run.</span></span> | <span data-ttu-id="028db-193">この変更により発生する可能性のある問題の対処方法については、ASP.NET Web サイトの「[ASP.NET 4 Breaking Changes (ASP.NET 4 の互換性に影響する変更点)](/aspnet/whitepapers/aspnet4/breaking-changes)」の「Event Handlers Might Not Be Not Raised in a Default Document in IIS 7 or IIS 7.5 Integrated Mode (IIS 7 または IIS 7.5 統合モードの既定のドキュメントで起動しない可能性のあるイベント ハンドラー)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-193">For information about ways to work around problems that might arise as a result of this change, see "Event Handlers Might Not Be Not Raised in a Default Document in IIS 7 or IIS 7.5 Integrated Mode" in the document [ASP.NET 4 Breaking Changes](/aspnet/whitepapers/aspnet4/breaking-changes) on the ASP.NET Web site.</span></span> |
| <span data-ttu-id="028db-194">**ハッシュ アルゴリズム**</span><span class="sxs-lookup"><span data-stu-id="028db-194">**Hashing algorithm**</span></span> | <span data-ttu-id="028db-195">ASP.NET では、暗号化とハッシュ アルゴリズムの両方を使用して、フォーム認証 Cookie やビュー ステートなどのデータをセキュリティで保護します。</span><span class="sxs-lookup"><span data-stu-id="028db-195">ASP.NET uses both encryption and hashing algorithms to help secure data such as forms authentication cookies and view state.</span></span> <span data-ttu-id="028db-196">既定では、ASP.NET 4 は Cookie とビュー ステートのハッシュ操作に <xref:System.Security.Cryptography.HMACSHA256> アルゴリズムを使用します。</span><span class="sxs-lookup"><span data-stu-id="028db-196">By default, ASP.NET 4 uses the <xref:System.Security.Cryptography.HMACSHA256> algorithm for hash operations on cookies and view state.</span></span> <span data-ttu-id="028db-197">旧バージョンの ASP.NET は、古い <xref:System.Security.Cryptography.HMACSHA1> アルゴリズムを使用していました。</span><span class="sxs-lookup"><span data-stu-id="028db-197">Earlier versions of ASP.NET used the older <xref:System.Security.Cryptography.HMACSHA1> algorithm.</span></span> | <span data-ttu-id="028db-198">ASP.NET 2.0 と ASP.NET 4 が混在し、フォーム認証 Cookie などのデータが複数の .NET Framework バージョンで動作する必要のあるアプリケーションを実行する場合は、Web.config ファイルに次の設定を追加して ASP.NET 4 Web アプリケーションを構成し、古い <xref:System.Security.Cryptography.HMACSHA1> アルゴリズムを使用するようにします。</span><span class="sxs-lookup"><span data-stu-id="028db-198">If you run applications that mix ASP.NET 2.0 and ASP.NET 4, where data such as forms authentication cookies must work across .NET Framework versions, configure an ASP.NET 4 Web application to use the older <xref:System.Security.Cryptography.HMACSHA1> algorithm by adding the following setting in the Web.config file:</span></span><br><br>`<machineKey validation="SHA1" />` |
| <span data-ttu-id="028db-199">**Internet Explorer でのコントロールのホスティング**</span><span class="sxs-lookup"><span data-stu-id="028db-199">**Hosting controls in Internet Explorer**</span></span> | <span data-ttu-id="028db-200">Web でコントロールをホストするための優れたソリューションが存在するため、Windows フォーム コントロールを Internet Explorer でホストすることができなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-200">You can no longer host Windows Forms controls in the Internet Explorer, because there are better solutions for hosting controls on the Web.</span></span> <span data-ttu-id="028db-201">このため、IEHost.dll と IEExec.exe アセンブリは .NET Framework から削除されました。</span><span class="sxs-lookup"><span data-stu-id="028db-201">Therefore, the IEHost.dll and IEExec.exe assemblies have been removed from the .NET Framework.</span></span> | <span data-ttu-id="028db-202">Web アプリケーションのカスタム コントロールの開発には、次のテクノロジが使用できます。</span><span class="sxs-lookup"><span data-stu-id="028db-202">You can use the following technologies for custom control development in Web applications:</span></span><br><br><span data-ttu-id="028db-203">\* Silverlight アプリケーションを作成し、ブラウザー外で実行されるように構成できます。</span><span class="sxs-lookup"><span data-stu-id="028db-203">\* You can create a Silverlight application and configure it to run outside the browser.</span></span> <span data-ttu-id="028db-204">詳細については、「[ブラウザー外実行のサポート](https://docs.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/dd550721%28v=vs.95%29)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-204">For more information, see [Out-of-Browser Support](https://docs.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/dd550721%28v=vs.95%29).</span></span><br><span data-ttu-id="028db-205">\* XAML ブラウザー アプリケーション (XBAP) を構築し、WPF 機能を活用することができます (クライアント マシン上に .NET Framework が必要です)。</span><span class="sxs-lookup"><span data-stu-id="028db-205">\* You can build a XAML browser application (XBAP) to take advantage of WPF capabilities (requires the .NET Framework on client machines).</span></span> <span data-ttu-id="028db-206">詳細については、「[WPF XAML ブラウザー アプリケーションの概要](../../../docs/framework/wpf/app-development/wpf-xaml-browser-applications-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-206">For more information, see [WPF XAML Browser Applications Overview](../../../docs/framework/wpf/app-development/wpf-xaml-browser-applications-overview.md).</span></span> |
| <span data-ttu-id="028db-207">**HtmlEncode メソッドと UrlEncode メソッド**</span><span class="sxs-lookup"><span data-stu-id="028db-207">**HtmlEncode and UrlEncode methods**</span></span> | <span data-ttu-id="028db-208"><xref:System.Web.HttpUtility> クラスと <xref:System.Web.HttpServerUtility> クラスの `HtmlEncode` メソッドと `UrlEncode` メソッドが更新され、単一引用符文字 (') が次のようにエンコードされるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-208">The `HtmlEncode` and `UrlEncode` methods of the <xref:System.Web.HttpUtility> and <xref:System.Web.HttpServerUtility> classes have been updated to encode the single quotation mark character (') as follows:</span></span><br><br><span data-ttu-id="028db-209">\* `HtmlEncode` メソッドは、単一引用符のインスタンスを `&#39;` としてエンコードします。</span><span class="sxs-lookup"><span data-stu-id="028db-209">\* The `HtmlEncode` method encodes instances of the single quotation mark as `&#39;`</span></span><br><span data-ttu-id="028db-210">\* `UrlEncode` メソッドは、単一引用符のインスタンスを `%27` としてエンコードします。</span><span class="sxs-lookup"><span data-stu-id="028db-210">\* The `UrlEncode` method encodes instances of the single quotation mark as `%27`</span></span> | <span data-ttu-id="028db-211">`HtmlEncode` メソッドと `UrlEncode` メソッドが使用されているコード内の箇所を調べ、エンコードの変更によってご使用のアプリケーションが影響を受けてないことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="028db-211">Examine your code for places where you use the `HtmlEncode` and `UrlEncode` methods, and make sure that the change in encoding does not result in a change that would affect your application.</span></span> |
| <span data-ttu-id="028db-212">**ASP.NET 2.0 アプリケーションでの HttpException エラー**</span><span class="sxs-lookup"><span data-stu-id="028db-212">**HttpException errors in ASP.NET 2.0 applications**</span></span> | <span data-ttu-id="028db-213">ASP.NET 4 を IIS 6 で有効にした後、(Windows Server 2003 または Windows Server 2003 R2 の) IIS 6 で実行された ASP.NET 2.0 アプリケーションで次のようなエラーが発生する可能性があります。`System.Web.HttpException: Path '/[yourApplicationRoot]/eurl.axd/[Value]' was not found.`</span><span class="sxs-lookup"><span data-stu-id="028db-213">After ASP.NET 4 has been enabled on IIS 6, ASP.NET 2.0 applications that run on IIS 6 (in either Windows Server 2003 or Windows Server 2003 R2) might generate errors such as the following: `System.Web.HttpException: Path '/[yourApplicationRoot]/eurl.axd/[Value]' was not found.`</span></span> | <span data-ttu-id="028db-214">\* Web サイトの実行に ASP.NET 4 が必要ない場合は、サイトをリマップして ASP.NET 2.0 が代わりに使用されるようにします。</span><span class="sxs-lookup"><span data-stu-id="028db-214">\* If ASP.NET 4 is not required in order to run the Web site, remap the site to use ASP.NET 2.0 instead.</span></span><br><br><span data-ttu-id="028db-215">- または -</span><span class="sxs-lookup"><span data-stu-id="028db-215">-or-</span></span><br><br><span data-ttu-id="028db-216">\* Web サイトの実行に ASP.NET 4 が必要な場合は、ASP.NET 2.0 の子仮想ディレクトリをすべて、ASP.NET 2.0 にマップされた別の Web サイトに移動させます。</span><span class="sxs-lookup"><span data-stu-id="028db-216">\* If ASP.NET 4 is required in order to run the Web site, move any child ASP.NET 2.0 virtual directories to a different Web site that is mapped to ASP.NET 2.0.</span></span><br><br><span data-ttu-id="028db-217">- または -</span><span class="sxs-lookup"><span data-stu-id="028db-217">-or-</span></span><br><br><span data-ttu-id="028db-218">\* 拡張子なしの URL を無効にします。</span><span class="sxs-lookup"><span data-stu-id="028db-218">\* Disable extensionless URLs.</span></span> <span data-ttu-id="028db-219">詳細については、ASP.NET Web サイトの「[ASP.NET 4 Breaking Changes (ASP.NET 4 の互換性に影響する変更点)](/aspnet/whitepapers/aspnet4/breaking-changes)」の「ASP.NET 2.0 Applications Might Generate HttpException Errors That Reference eurl.axd (ASP.NET 2.0 アプリケーションで eurl.axd を参照する HttpException エラーが発生することがある)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-219">For more information, see "ASP.NET 2.0 Applications Might Generate HttpException Errors That Reference eurl.axd" in the document [ASP.NET 4 Breaking Changes](/aspnet/whitepapers/aspnet4/breaking-changes) on the ASP.NET Web site.</span></span> |
| <span data-ttu-id="028db-220">**メンバーシップ タイプ**</span><span class="sxs-lookup"><span data-stu-id="028db-220">**Membership types**</span></span> | <span data-ttu-id="028db-221">ASP.NET メンバーシップで使用される一部のタイプ (例: <xref:System.Web.Security.MembershipProvider>) は、System.Web.dll から System.Web.ApplicationServices.dll アセンブリに移動しました。</span><span class="sxs-lookup"><span data-stu-id="028db-221">Some types (for example, <xref:System.Web.Security.MembershipProvider>) that are used in ASP.NET membership have been moved from System.Web.dll to the System.Web.ApplicationServices.dll assembly.</span></span> <span data-ttu-id="028db-222">これらのタイプは、クライアントのタイプと拡張 .NET Framework SKU のタイプとの間のアーキテクチャ層の依存関係を解決するために移動しました。</span><span class="sxs-lookup"><span data-stu-id="028db-222">The types were moved in order to resolve architectural layering dependencies between types in the client and in extended .NET Framework SKUs.</span></span> | <span data-ttu-id="028db-223">旧バージョンの ASP.NET からアップグレードされた、移動したメンバーシップ タイプを使用するクラス ライブラリを ASP.NET 4 プロジェクトで使用すると、コンパイルに失敗することがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-223">Class libraries that have been upgraded from earlier versions of ASP.NET and that use membership types that have been moved might fail to compile when used in an ASP.NET 4 project.</span></span> <span data-ttu-id="028db-224">この場合は、System.Web.ApplicationServices.dll への参照をクラス ライブラリ プロジェクトに追加します。</span><span class="sxs-lookup"><span data-stu-id="028db-224">If so, add a reference in the class library project to System.Web.ApplicationServices.dll.</span></span> |
| <span data-ttu-id="028db-225">**メニュー コントロールの変更**</span><span class="sxs-lookup"><span data-stu-id="028db-225">**Menu control changes**</span></span> | <span data-ttu-id="028db-226"><xref:System.Web.UI.WebControls.Menu> コントロールの変更によって、以下の動作が発生します。</span><span class="sxs-lookup"><span data-stu-id="028db-226">Changes to the <xref:System.Web.UI.WebControls.Menu> control result in the following behavior:</span></span><br><br><span data-ttu-id="028db-227">\* <xref:System.Web.UI.WebControls.MenuRenderingMode> が `List` に設定されている場合、または <xref:System.Web.UI.WebControls.MenuRenderingMode> が `Default` に設定され、<xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> が `4.0` 以降に設定されている場合、<xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> プロパティは無効です。</span><span class="sxs-lookup"><span data-stu-id="028db-227">\* If <xref:System.Web.UI.WebControls.MenuRenderingMode> is set to `List`, or if <xref:System.Web.UI.WebControls.MenuRenderingMode> is set to `Default` and <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> is set to `4.0` or later, the <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> property has no effect.</span></span><br><span data-ttu-id="028db-228">\* <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> プロパティと <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> プロパティに設定されたパスに円記号 (\\) が含まれている場合、イメージはレンダリングされません </span><span class="sxs-lookup"><span data-stu-id="028db-228">\* If the path that is set in the <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> and <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> properties contains a backslash (\\), the images do not render.</span></span> <span data-ttu-id="028db-229">(旧バージョンの ASP.NET では、パスに円記号を含めることができました)。</span><span class="sxs-lookup"><span data-stu-id="028db-229">(In earlier versions of ASP.NET, the path could include a backslash.)</span></span> | <span data-ttu-id="028db-230">\* 個々のメニュー項目に対して <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> プロパティを設定する代わりに、親の <xref:System.Web.UI.WebControls.Menu> コントロールの <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> または <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> を設定します。</span><span class="sxs-lookup"><span data-stu-id="028db-230">\* Instead of setting the <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> property for individual menu items, set the <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> or <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> of the parent <xref:System.Web.UI.WebControls.Menu> control.</span></span><br><br><span data-ttu-id="028db-231">- または -</span><span class="sxs-lookup"><span data-stu-id="028db-231">-or-</span></span><br><br><span data-ttu-id="028db-232"><xref:System.Web.UI.WebControls.MenuRenderingMode> を `Table` に設定します。または、<xref:System.Web.UI.WebControls.MenuRenderingMode> を `Default` に設定し、<xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> を `3.5` に設定します。</span><span class="sxs-lookup"><span data-stu-id="028db-232">Set <xref:System.Web.UI.WebControls.MenuRenderingMode> to `Table`, or set <xref:System.Web.UI.WebControls.MenuRenderingMode> to `Default` and set <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> to `3.5`.</span></span> <span data-ttu-id="028db-233">これらの設定により、<xref:System.Web.UI.WebControls.Menu> コントロールで、旧バージョンの ASP.NET で使用された HTML テーブル ベースのレイアウトが使用されます。</span><span class="sxs-lookup"><span data-stu-id="028db-233">These settings cause the <xref:System.Web.UI.WebControls.Menu> control to use the HTML table-based layout that it used in earlier versions of ASP.NET.</span></span><br><span data-ttu-id="028db-234">\* <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> プロパティまたは <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> プロパティのパスに円記号 (\\) が含まれている場合は、スラッシュ文字 (/) に置き換えます。</span><span class="sxs-lookup"><span data-stu-id="028db-234">\* If the path in the <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> or <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> property contains a backslash (\\), substitute a slash character (/).</span></span> |
| <span data-ttu-id="028db-235">**Web.config ファイル内の Mobile アセンブリ**</span><span class="sxs-lookup"><span data-stu-id="028db-235">**Mobile assembly in Web.config file**</span></span> | <span data-ttu-id="028db-236">以前のバージョンの ASP.NET では、System.Web.Mobile.dll アセンブリへの参照は、`system.web`/`compilation` の `assemblies` セクションにある、ルートの Web.config ファイルに含まれていました。</span><span class="sxs-lookup"><span data-stu-id="028db-236">In previous versions of ASP.NET, a reference to the System.Web.Mobile.dll assembly was included in the root Web.config file in the `assemblies` section under `system.web`/`compilation`.</span></span> <span data-ttu-id="028db-237">パフォーマンスを向上させるために、このアセンブリへの参照は削除されました。</span><span class="sxs-lookup"><span data-stu-id="028db-237">To improve performance, the reference to this assembly has been removed.</span></span><br><br><span data-ttu-id="028db-238">メモ:System.Web.Mobile.dll アセンブリと ASP.NET モバイル コントロールは ASP.NET 4 に含まれていますが、それらの使用は非推奨とされました。</span><span class="sxs-lookup"><span data-stu-id="028db-238">Note: The System.Web.Mobile.dll assembly and the ASP.NET mobile controls are included in ASP.NET 4, but they are deprecated.</span></span> | <span data-ttu-id="028db-239">このアセンブリに含まれる型を使用する場合は、ルートの Web.config ファイルまたはアプリケーションの Web.config ファイルにアセンブリへの参照を追加します。</span><span class="sxs-lookup"><span data-stu-id="028db-239">If you want to use types from this assembly, add a reference to the assembly in either the root Web.config file or in an application Web.config file.</span></span> |
| <span data-ttu-id="028db-240">**出力キャッシュ**</span><span class="sxs-lookup"><span data-stu-id="028db-240">**Output caching**</span></span> | <span data-ttu-id="028db-241">ASP.NET 1.0 のバグが原因で、出力キャッシュの設定として `Location="ServerAndClient"` が指定されたキャッシュ ページでは、応答に `Vary:*` HTTP ヘッダーが生成されていました。</span><span class="sxs-lookup"><span data-stu-id="028db-241">In ASP.NET 1.0, a bug caused cached pages that specified `Location="ServerAndClient"` as an output€“cache setting to emit a `Vary:*` HTTP header in the response.</span></span> <span data-ttu-id="028db-242">その結果、クライアント ブラウザーに対して、ローカルにページをキャッシュしないように指示がなされていました。</span><span class="sxs-lookup"><span data-stu-id="028db-242">This had the effect of telling client browsers to never cache the page locally.</span></span> <span data-ttu-id="028db-243">ASP.NET 1.1 では、<xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> メソッドが追加され、`Vary:*` ヘッダーを抑制するためにこのメソッドを呼び出すことができました。</span><span class="sxs-lookup"><span data-stu-id="028db-243">In ASP.NET 1.1, the <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> method was added, which could be called in order to suppress the `Vary:*` header.</span></span> <span data-ttu-id="028db-244">ただし、バグ報告では、開発者が既存の `SetOmitVaryStar` の動作を認識していないことが示唆されています。</span><span class="sxs-lookup"><span data-stu-id="028db-244">However, bug reports suggest that developers are unaware of the existing `SetOmitVaryStar` behavior.</span></span><br><br><span data-ttu-id="028db-245">ASP.NET 4 では、次のディレクティブを指定する応答から `Vary:*` HTTP ヘッダーは生成されなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-245">In ASP.NET 4, the `Vary:*` HTTP header is no longer emitted from responses that specify the following directive:</span></span><br><br>`<%@ OutputCache Location="ServerAndClient" %>`<br><br><span data-ttu-id="028db-246">そのため、<xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> ヘッダーを無効にするための `Vary:*` メソッドは不要になりました。</span><span class="sxs-lookup"><span data-stu-id="028db-246">As a result, the <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> method is no longer needed in order to suppress the `Vary:*` header.</span></span> <span data-ttu-id="028db-247">`Location` 属性に "ServerAndClient" を指定するアプリケーションでは、<xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> を呼び出す必要なくブラウザーにページをキャッシュできます。</span><span class="sxs-lookup"><span data-stu-id="028db-247">In applications that specify "ServerAndClient" for the `Location` attribute, pages will be cacheable in the browser without requiring that you call <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A>.</span></span> | <span data-ttu-id="028db-248">アプリケーション内のページで `Vary:*` を生成する必要がある場合は、次の例に示すように <xref:System.Web.HttpResponse.AppendHeader%2A> メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="028db-248">If pages in the application must emit `Vary:*`, call the <xref:System.Web.HttpResponse.AppendHeader%2A> method as shown in the following example:</span></span><br><br>`System.Web.HttpResponse.AppendHeader("Vary","*");`<br><br><span data-ttu-id="028db-249">または、出力キャッシュ `Location` 属性の値を "Server" に変更できます。</span><span class="sxs-lookup"><span data-stu-id="028db-249">Alternatively, you can change the value of the output caching `Location` attribute to "Server".</span></span> |
| <span data-ttu-id="028db-250">**ページの解析**</span><span class="sxs-lookup"><span data-stu-id="028db-250">**Page parsing**</span></span> | <span data-ttu-id="028db-251">ASP.NET Web ページ (.aspx ファイル) とユーザー コントロール (.ascx ファイル) のページ パーサーは、旧バージョンの ASP.NET よりも ASP.NET 4 の方が厳密であり、無効とみなされて警告が出力されるマークアップの数が、旧バージョンに比べて多くなります。</span><span class="sxs-lookup"><span data-stu-id="028db-251">The page parser for ASP.NET Web pages (.aspx files) and user controls (.ascx files) is stricter in ASP.NET 4 than in earlier versions of ASP.NET, and it flags more markup as invalid than in earlier versions.</span></span> | <span data-ttu-id="028db-252">ページの実行時に出力されたエラー メッセージを調べて、無効なマークアップが原因で発生したエラーを修正します。</span><span class="sxs-lookup"><span data-stu-id="028db-252">Examine error messages that are produced when a page runs and fix errors that result from invalid markup.</span></span> |
| <span data-ttu-id="028db-253">**Passport 型**</span><span class="sxs-lookup"><span data-stu-id="028db-253">**Passport types**</span></span> | <span data-ttu-id="028db-254">Passport (現在の Live ID SDK) の変更により、ASP.NET 2.0 に組み込まれた Passport のサポートは廃止され、サポートされなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-254">The Passport support built into ASP.NET 2.0 is obsolete and is unsupported due to changes in Passport (now Live ID SDK).</span></span> <span data-ttu-id="028db-255">その結果、<xref:System.Web.Security> の Passport に関連する型は、`ObsoleteAttribute` 属性としてマークされるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-255">As a result, the types related to Passport in <xref:System.Web.Security> are now marked with the `ObsoleteAttribute` attribute.</span></span> | <span data-ttu-id="028db-256"><xref:System.Web.Security> 名前空間の Passport 型 (たとえば、<xref:System.Web.Security.PassportIdentity>) を使用するコードは、[SDK](https://go.microsoft.com/fwlink/?LinkId=106346) を使用するように変更してください。</span><span class="sxs-lookup"><span data-stu-id="028db-256">Change any code you have that uses Passport types in the <xref:System.Web.Security> namespace (for example, <xref:System.Web.Security.PassportIdentity>) to use the [SDK](https://go.microsoft.com/fwlink/?LinkId=106346).</span></span> |
| <span data-ttu-id="028db-257">**FilePath プロパティの PathInfo 情報**</span><span class="sxs-lookup"><span data-stu-id="028db-257">**PathInfo information in the FilePath property**</span></span> | <span data-ttu-id="028db-258">ASP.NET 4 では、<xref:System.Web.HttpRequest.FilePath>、<xref:System.Web.HttpRequest.AppRelativeCurrentExecutionFilePath>、<xref:System.Web.HttpRequest.CurrentExecutionFilePath> などのプロパティからの戻り値に `PathInfo` 値が含まれなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-258">ASP.NET 4 no longer includes the `PathInfo` value in the return values from properties such as <xref:System.Web.HttpRequest.FilePath>, <xref:System.Web.HttpRequest.AppRelativeCurrentExecutionFilePath>, and <xref:System.Web.HttpRequest.CurrentExecutionFilePath>.</span></span> <span data-ttu-id="028db-259">代わりに、<xref:System.Web.HttpRequest.PathInfo> 内の `PathInfo` 情報が使用できます。</span><span class="sxs-lookup"><span data-stu-id="028db-259">Instead, the `PathInfo` information is available in <xref:System.Web.HttpRequest.PathInfo>.</span></span> <span data-ttu-id="028db-260">たとえば、次のような URL フラグメントがあるとします。</span><span class="sxs-lookup"><span data-stu-id="028db-260">For example, imagine the following URL fragment:</span></span><br><br>`/testapp/Action.mvc/SomeAction`<br><br><span data-ttu-id="028db-261">旧バージョンの ASP.NET では、<xref:System.Web.HttpRequest> プロパティは次の値を持ちます。</span><span class="sxs-lookup"><span data-stu-id="028db-261">In earlier versions of ASP.NET, <xref:System.Web.HttpRequest> properties have the following values:</span></span><br><br><span data-ttu-id="028db-262">\* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc/SomeAction`</span><span class="sxs-lookup"><span data-stu-id="028db-262">\* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc/SomeAction`</span></span><br><span data-ttu-id="028db-263">\* <xref:System.Web.HttpRequest.PathInfo>: (空)</span><span class="sxs-lookup"><span data-stu-id="028db-263">\* <xref:System.Web.HttpRequest.PathInfo>: (empty)</span></span><br><br><span data-ttu-id="028db-264">ASP.NET 4 では、<xref:System.Web.HttpRequest> プロパティは代わりに次の値を持ちます。</span><span class="sxs-lookup"><span data-stu-id="028db-264">In ASP.NET 4, <xref:System.Web.HttpRequest> properties instead have the following values:</span></span><br><br><span data-ttu-id="028db-265">\* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc`</span><span class="sxs-lookup"><span data-stu-id="028db-265">\* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc`</span></span><br><span data-ttu-id="028db-266">\* <xref:System.Web.HttpRequest.PathInfo>: `SomeAction`</span><span class="sxs-lookup"><span data-stu-id="028db-266">\* <xref:System.Web.HttpRequest.PathInfo>: `SomeAction`</span></span> | <span data-ttu-id="028db-267"><xref:System.Web.HttpRequest> クラスのプロパティに依存してパス情報を返しているコード内の箇所を調べます。コードを変更して、パス情報の返し方に関する変更を反映させてください。</span><span class="sxs-lookup"><span data-stu-id="028db-267">Examine your code for places where you rely on properties of the <xref:System.Web.HttpRequest> class to return path information; change the code to reflect the changes in how path information is returned.</span></span> |
| <span data-ttu-id="028db-268">**要求の検証**</span><span class="sxs-lookup"><span data-stu-id="028db-268">**Request validation**</span></span> | <span data-ttu-id="028db-269">要求の検証を改善するために、ASP.NET 要求の検証は、要求ライフ サイクルの初期に呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="028db-269">To improve request validation, the ASP.NET request validation is invoked earlier in the request life cycle.</span></span> <span data-ttu-id="028db-270">その結果、要求の検証は、Web サービスの呼び出しやカスタム ハンドラーに対する要求など、.aspx ファイルが対象ではない要求に対して実行されます。</span><span class="sxs-lookup"><span data-stu-id="028db-270">As a result, request validation runs for requests that are not for .aspx files, such as for Web service calls and for custom handlers.</span></span> <span data-ttu-id="028db-271">要求の検証は、カスタム HTTP モジュールが要求処理パイプラインで実行されている場合にもアクティブになります。</span><span class="sxs-lookup"><span data-stu-id="028db-271">Request validation will also be active when custom HTTP modules are running in the request processing pipeline.</span></span><br><br><span data-ttu-id="028db-272">この変更の結果、.aspx ファイル以外のリソースに対する要求では、要求検証エラーがスローされることがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-272">As a result of this change, requests for resources other than .aspx files might throw request validation errors.</span></span> <span data-ttu-id="028db-273">要求パイプラインで実行されるカスタム コード (たとえば、カスタム HTTP モジュール) も、要求検証エラーをスローすることがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-273">Custom code that runs in the request pipeline (for example, custom HTTP modules) might also throw request validation errors.</span></span> | <span data-ttu-id="028db-274">必要に応じて、Web 構成ファイルで次の設定を使用することにより、.aspx ページでのみ要求検証を起動する古い動作に戻すことができます。</span><span class="sxs-lookup"><span data-stu-id="028db-274">If necessary, you can revert to the old behavior of having only .aspx pages triggering request validation by using the following setting in the Web configuration file:</span></span><br><br>`<httpRuntime requestValidationMode="2.0" />`<br><br><span data-ttu-id="028db-275">警告 :古い動作に戻す場合は、既存のハンドラー、モジュール、その他のカスタム コード内のすべてのコードで、安全でない (XSS 攻撃ベクターである) 可能性のある HTTP 入力がチェックされることを確認します。</span><span class="sxs-lookup"><span data-stu-id="028db-275">Warning: If you revert to the old behavior, make sure that all code in existing handlers, modules, and other custom code performs checks for potentially unsafe HTTP inputs that could be XSS attack vectors.\`</span></span> |
| <span data-ttu-id="028db-276">**ルーティング**</span><span class="sxs-lookup"><span data-stu-id="028db-276">**Routing**</span></span> | <span data-ttu-id="028db-277">Visual Studio 2010 でファイル システム Web サイトを作成するときに、その Web サイトがフォルダー名にドット (.) を含むフォルダー内にある場合、URL ルーティングは正常に動作しません。</span><span class="sxs-lookup"><span data-stu-id="028db-277">If you create a file system Web site in Visual Studio 2010 and the Web site is in a folder that contains a dot (.) in the folder name, URL routing will not work reliably.</span></span> <span data-ttu-id="028db-278">一部の仮想パスから、HTTP 404 エラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="028db-278">An HTTP 404 error is returned from some virtual paths.</span></span> <span data-ttu-id="028db-279">これが発生するのは、Visual Studio 2010 がルート仮想ディレクトリに正しくないパスを使用して Visual Studio 開発サーバーを起動するためです。</span><span class="sxs-lookup"><span data-stu-id="028db-279">This occurs because Visual Studio 2010 launches the Visual Studio Development Server using an incorrect path for the root virtual directory.</span></span> | <span data-ttu-id="028db-280">\* ファイル ベースの Web サイトの **[プロパティ]** ページで、**仮想パス**属性を "/" に変更します。</span><span class="sxs-lookup"><span data-stu-id="028db-280">\* In the **Properties** page for the file-based Web site, change the **Virtual Path** attribute to "/".</span></span><br><br><span data-ttu-id="028db-281">- または -</span><span class="sxs-lookup"><span data-stu-id="028db-281">-or-</span></span><br><br><span data-ttu-id="028db-282">\* Web サイト プロジェクトの代わりに、Web アプリケーション プロジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="028db-282">\* Create a Web application project instead of a Web site project.</span></span> <span data-ttu-id="028db-283">Web アプリケーション プロジェクトではこの問題は発生しません。プロジェクト フォルダーの名前にドットが含まれている場合でも、URL ルーティングは動作します。</span><span class="sxs-lookup"><span data-stu-id="028db-283">Web application projects do not have this issue, and URL routing works even if the project folder has a dot in its name.</span></span><br><br><span data-ttu-id="028db-284">- または -</span><span class="sxs-lookup"><span data-stu-id="028db-284">-or-</span></span><br><br><span data-ttu-id="028db-285">\* IIS でホストされる HTTP ベースの Web サイトを作成します。</span><span class="sxs-lookup"><span data-stu-id="028db-285">\* Create an HTTP-based Web site that is hosted in IIS.</span></span> <span data-ttu-id="028db-286">IIS でホストされる Web サイトでは、プロジェクト ファイル フォルダーと同様に、仮想パスでもドットを使用できます。</span><span class="sxs-lookup"><span data-stu-id="028db-286">IIS-hosted Web sites can have dots in the virtual path as well as in the project file folder.</span></span> |
| <span data-ttu-id="028db-287">**SharePoint サイト**</span><span class="sxs-lookup"><span data-stu-id="028db-287">**SharePoint sites**</span></span> | <span data-ttu-id="028db-288">`WSS_Minimal` という名前のカスタムの部分信頼レベルを含む SharePoint Web サイトの子として配置された ASP.NET 4 Web サイトを実行しようとすると、次のエラーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="028db-288">If you try to run an ASP.NET 4 Web site that is deployed as a child of a SharePoint Web site that contains a custom partial-trust level named `WSS_Minimal`, you will see the following error:</span></span><br><br>`Could not find permission set named 'ASP.Net'.` | <span data-ttu-id="028db-289">現時点では、ASP.NET と互換性がある SharePoint のバージョンはありません。</span><span class="sxs-lookup"><span data-stu-id="028db-289">Currently, no versions of SharePoint are compatible with ASP.NET.</span></span> <span data-ttu-id="028db-290">このため、ASP.NET 4 Web サイトを、SharePoint Web サイトの子として実行しないでください。</span><span class="sxs-lookup"><span data-stu-id="028db-290">As a result, you should not attempt to run an ASP.NET 4 Web site as a child of a SharePoint Web site.</span></span> |
| <span data-ttu-id="028db-291">**XHTML 1.1 標準**</span><span class="sxs-lookup"><span data-stu-id="028db-291">**XHTML 1.1 standards**</span></span> | <span data-ttu-id="028db-292">新しい Web サイトの XHTML 1.1 への準拠を有効にするために、.NET Framework 4 の ASP.NET コントロールでは、XHTML 1.1 準拠の HTML が生成されます。</span><span class="sxs-lookup"><span data-stu-id="028db-292">To enable XHTML 1.1 compliance for new Web sites, the ASP.NET controls in the .NET Framework 4 will generate XHTML 1.1 compliant HTML.</span></span> <span data-ttu-id="028db-293">この表示は、Web.config ファイルの `<system.Web>` 要素内で次のオプションを使用することで有効にできます。</span><span class="sxs-lookup"><span data-stu-id="028db-293">This rendering is enabled using the following option in the Web.config file inside the `<system.Web>` element:</span></span><br><br>`<pages controlRenderingCompatibilityVersion="4.0"/>`<br><br><span data-ttu-id="028db-294">このオプションは、既定で 4.0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="028db-294">This option is set by default to 4.0.</span></span> <span data-ttu-id="028db-295">Visual Studio 2008 からアップグレードされた Web プロジェクトでは、互換性のために 3.5 の設定が有効になります。</span><span class="sxs-lookup"><span data-stu-id="028db-295">Web projects that are upgraded from Visual Studio 2008 have the 3.5 setting enabled for compatibility.</span></span> | <span data-ttu-id="028db-296">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-296">None.</span></span> |

## <a name="core"></a><span data-ttu-id="028db-297">コア</span><span class="sxs-lookup"><span data-stu-id="028db-297">Core</span></span>

### <a name="general-features"></a><span data-ttu-id="028db-298">一般機能</span><span class="sxs-lookup"><span data-stu-id="028db-298">General features</span></span>

| <span data-ttu-id="028db-299">機能</span><span class="sxs-lookup"><span data-stu-id="028db-299">Feature</span></span> | <span data-ttu-id="028db-300">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-300">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-301">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-301">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-302">**CardSpace**</span><span class="sxs-lookup"><span data-stu-id="028db-302">**CardSpace**</span></span> | <span data-ttu-id="028db-303">Windows CardSpace は、.NET Framework には含まれる形ではなく、単独で提供されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-303">Windows CardSpace is no longer included in the .NET Framework; it is provided separately.</span></span> | <span data-ttu-id="028db-304">[Microsoft ダウンロード センター](https://go.microsoft.com/fwlink/?LinkId=199868)から Windows CardSpace をダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="028db-304">Download Windows CardSpace from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?LinkId=199868).</span></span> |
| <span data-ttu-id="028db-305">**構成ファイル**</span><span class="sxs-lookup"><span data-stu-id="028db-305">**Configuration files**</span></span> | <span data-ttu-id="028db-306">.NET Framework によるアプリケーション構成ファイルへのアクセス方法が修正されました。</span><span class="sxs-lookup"><span data-stu-id="028db-306">Corrections have been made in how the .NET Framework accesses application configuration files.</span></span> | <span data-ttu-id="028db-307">アプリケーション構成ファイルの名前が *アプリケーション名.config* の場合は、*アプリケーション名.exe.config* に変更します。たとえば、*MyApp.config* を *MyApp.exe.config* に変更します。</span><span class="sxs-lookup"><span data-stu-id="028db-307">If your application configuration file is named *application-name.config*, rename it to *application-name.exe.config*. For example, rename *MyApp.config* to *MyApp.exe.config*.</span></span> |
| <span data-ttu-id="028db-308">**C# コード コンパイラ**</span><span class="sxs-lookup"><span data-stu-id="028db-308">**C# code compiler**</span></span> | <span data-ttu-id="028db-309"><xref:Microsoft.CSharp> 名前空間にあった `Compiler` クラス、`CompilerError` クラス、`ErrorLevel` クラスは使用できなくなったため、これらのアセンブリ (cscompmgd.dll) は .NET Framework に含まれていません。</span><span class="sxs-lookup"><span data-stu-id="028db-309">The `Compiler`, `CompilerError`, and `ErrorLevel` classes that were in the <xref:Microsoft.CSharp> namespace are no longer available, and their assembly (cscompmgd.dll) is no longer included in the .NET Framework.</span></span> | <span data-ttu-id="028db-310"><xref:System.CodeDom.Compiler.CodeDomProvider>クラスや <xref:System.CodeDom.Compiler> 名前空間の他のクラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="028db-310">Use the <xref:System.CodeDom.Compiler.CodeDomProvider> class and other classes in the <xref:System.CodeDom.Compiler> namespace.</span></span> <span data-ttu-id="028db-311">詳細については、「[CodeDOM の使用](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/y2k85ax6%28v=vs.100%29)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-311">For more information, see [Using the CodeDOM](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/y2k85ax6%28v=vs.100%29).</span></span> |
| <span data-ttu-id="028db-312">**ホスティング** (アンマネージ API)</span><span class="sxs-lookup"><span data-stu-id="028db-312">**Hosting** (unmanaged API)</span></span> | <span data-ttu-id="028db-313">ホスティング機能を改善するために、ホスティング アクティブ化 API の一部が非推奨となくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-313">To improve hosting capabilities, some of the hosting activation APIs have been deprecated.</span></span> <span data-ttu-id="028db-314">インプロセス side-by-side 実行機能を使用すると、アプリケーションは複数のバージョンの .NET Framework を同じプロセスで読み込んで起動することができます。</span><span class="sxs-lookup"><span data-stu-id="028db-314">In-process side-by-side execution features enable an application to load and start multiple versions of the .NET Framework in the same process.</span></span> <span data-ttu-id="028db-315">たとえば、.NET Framework 2.0 SP1 ベースのアドイン (またはコンポーネント) と .NET Framework 4 ベースのアドインを同じプロセスで読み込むアプリケーションを実行できます。</span><span class="sxs-lookup"><span data-stu-id="028db-315">For example, you can run applications that load add-ins (or components) that are based on the .NET Framework 2.0 SP1 and add-ins that are based on the .NET Framework 4 in the same process.</span></span> <span data-ttu-id="028db-316">古いコンポーネントは古いバージョンの .NET Framework を引き続き使用し、新しいコンポーネントは新しいバージョンの .NET Framework を使用します。</span><span class="sxs-lookup"><span data-stu-id="028db-316">Older components continue to use the older .NET Framework version, and new components use the new .NET Framework version.</span></span> | <span data-ttu-id="028db-317">「[インプロセスの side-by-side 実行](../../../docs/framework/deployment/in-process-side-by-side-execution.md)」で説明されている構成を使用します。</span><span class="sxs-lookup"><span data-stu-id="028db-317">Use the configurations described in [In-Process Side-by-Side Execution](../../../docs/framework/deployment/in-process-side-by-side-execution.md).</span></span> |
| <span data-ttu-id="028db-318">**新しいセキュリティ モデル**</span><span class="sxs-lookup"><span data-stu-id="028db-318">**New security model**</span></span> | <span data-ttu-id="028db-319">「[.NET Framework 4 におけるセキュリティの変更点](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233103%28v=vs.100%29)」で説明しているように、コード アクセス セキュリティ (CAS) ポリシーはオフになり、簡略化されたモデルで置換されています。</span><span class="sxs-lookup"><span data-stu-id="028db-319">The code access security (CAS) policy has been turned off and replaced with a simplified model, as described in [Security Changes in the .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233103%28v=vs.100%29).</span></span> | <span data-ttu-id="028db-320">アプリケーションで CAS に依存している場合は、変更が必要になることがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-320">Modifications may be required if you depend on CAS in your applications.</span></span> <span data-ttu-id="028db-321">詳細については、「[コード アクセス セキュリティ ポリシーの互換性と移行](../../../docs/framework/misc/code-access-security-policy-compatibility-and-migration.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-321">For more information, see [Code Access Security Policy Compatibility and Migration](../../../docs/framework/misc/code-access-security-policy-compatibility-and-migration.md).</span></span> |

### <a name="date-and-time"></a><span data-ttu-id="028db-322">日付と時刻</span><span class="sxs-lookup"><span data-stu-id="028db-322">Date and time</span></span>

<span data-ttu-id="028db-323">名前空間: <xref:System>。アセンブリ: mscorlib (mscorlib.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-323">Namespace: <xref:System>; assembly: mscorlib (in mscorlib.dll)</span></span>

| <span data-ttu-id="028db-324">機能</span><span class="sxs-lookup"><span data-stu-id="028db-324">Feature</span></span> | <span data-ttu-id="028db-325">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-325">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-326">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-326">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-327">**夏時間**</span><span class="sxs-lookup"><span data-stu-id="028db-327">**Daylight savings**</span></span> | <span data-ttu-id="028db-328">システム クロックと一貫させるために、時間プロパティ (<xref:System.TimeZoneInfo.Local> や <xref:System.DateTime.Now> など) では、夏時間操作に他の .NET Framework データではなくオペレーティング システム規則を使用するようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-328">To be consistent with the system clock, time properties (such as <xref:System.TimeZoneInfo.Local> and <xref:System.DateTime.Now>) now use operating system rules instead of other .NET Framework data for daylight saving time operations.</span></span> | <span data-ttu-id="028db-329">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-329">None.</span></span> |
| <span data-ttu-id="028db-330">**書式指定文字列**</span><span class="sxs-lookup"><span data-stu-id="028db-330">**Formatting strings**</span></span> | <span data-ttu-id="028db-331">カルチャで区別される書式設定をサポートするために、新しい `ParseExact` メソッドと `TryParseExact` メソッドに加えて、`ToString`、`Parse`、`TryParse` などのメソッドの新しいオーバーロードが <xref:System.TimeSpan> 構造体に含まれています。</span><span class="sxs-lookup"><span data-stu-id="028db-331">To support culture-sensitive formatting, the <xref:System.TimeSpan> structure includes new overloads of the `ToString`, `Parse`, and `TryParse` methods in addition to new `ParseExact` and `TryParseExact` methods.</span></span> | <span data-ttu-id="028db-332">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-332">None.</span></span> |


### <a name="globalization"></a><span data-ttu-id="028db-333">グローバリゼーション</span><span class="sxs-lookup"><span data-stu-id="028db-333">Globalization</span></span>

<span data-ttu-id="028db-334">新しいニュートラル カルチャと特定のカルチャの一覧については、「[グローバリゼーションとローカリゼーションの新機能](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd997383%28v=vs.100%29)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-334">For a list of new neutral and specific cultures, see [What's New in Globalization and Localization](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd997383%28v=vs.100%29).</span></span>

<span data-ttu-id="028db-335">名前空間: <xref:System.Globalization>。アセンブリ: mscorlib (mscorlib.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-335">Namespace: <xref:System.Globalization>; assembly: mscorlib (in mscorlib.dll)</span></span>

| <span data-ttu-id="028db-336">機能</span><span class="sxs-lookup"><span data-stu-id="028db-336">Feature</span></span> | <span data-ttu-id="028db-337">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-337">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-338">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-338">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-339">**カルチャ名**</span><span class="sxs-lookup"><span data-stu-id="028db-339">**Culture names**</span></span> | <span data-ttu-id="028db-340">次の名前変更は、ドイツ語、ディベヒ語、アフリカーンス語のカルチャに影響します。</span><span class="sxs-lookup"><span data-stu-id="028db-340">The following name changes affect the German, Divehi, and African cultures:</span></span><br><br><span data-ttu-id="028db-341">\* <xref:System.Globalization.CultureAndRegionInfoBuilder.CurrencyEnglishName>: ドイツ語 (スイス) (de-CH) カルチャの通貨名は "sFr." から </span><span class="sxs-lookup"><span data-stu-id="028db-341">\* <xref:System.Globalization.CultureAndRegionInfoBuilder.CurrencyEnglishName>: The currency name for the German (Switizerland) (de-CH) culture has changed from "sFr."</span></span> <span data-ttu-id="028db-342">"Fr." に変更されました。</span><span class="sxs-lookup"><span data-stu-id="028db-342">to "Fr.".</span></span><br><span data-ttu-id="028db-343">\* <xref:System.Globalization.DateTimeFormatInfo.LongDatePattern>: ディベヒ語 (モルディブ) (dv-MV) カルチャの長い日付パターンは、"dd/MMMM/yyyy" から "dd/MM/yyyy" に変更されました。</span><span class="sxs-lookup"><span data-stu-id="028db-343">\* <xref:System.Globalization.DateTimeFormatInfo.LongDatePattern>: The long date pattern for the Divehi (Maldives) (dv-MV) culture has changed from "dd/MMMM/yyyy" to "dd/MM/yyyy".</span></span><br><span data-ttu-id="028db-344">\* <xref:System.Globalization.DateTimeFormatInfo.PMDesignator>: </span><span class="sxs-lookup"><span data-stu-id="028db-344">\* <xref:System.Globalization.DateTimeFormatInfo.PMDesignator>: The P.M.</span></span> <span data-ttu-id="028db-345">アフリカーンス語 (南アフリカ) (af-ZA) カルチャの午後指定子は、"nm" から "PM" に変更されました。</span><span class="sxs-lookup"><span data-stu-id="028db-345">designator of the Afrikaans (South Africa) (af-ZA) culture has changed from "nm" to "PM".</span></span> | <span data-ttu-id="028db-346">カルチャ名の変更に注意してください。</span><span class="sxs-lookup"><span data-stu-id="028db-346">Note culture name changes.</span></span> |
| <span data-ttu-id="028db-347">**LCID パラメーター**</span><span class="sxs-lookup"><span data-stu-id="028db-347">**LCID parameter**</span></span> | <span data-ttu-id="028db-348">オートメーション サーバー設定で予期される動作と一貫させるために、CLR はアンマネージ COM ベースのアプリケーションに `LCID` パラメーターの現在のカルチャを渡さなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-348">To be consistent with expected behavior in automation server settings, the CLR no longer passes the current culture for the `LCID` parameter to unmanaged COM-based applications.</span></span> <span data-ttu-id="028db-349">代わりに、カルチャとして 1033 (en-us) が渡されます。</span><span class="sxs-lookup"><span data-stu-id="028db-349">Instead, it passes 1033 (en-us) for the culture.</span></span> | <span data-ttu-id="028db-350">指定したカルチャを必要とするネイティブ アプリケーションを除き、変更は不要です。</span><span class="sxs-lookup"><span data-stu-id="028db-350">No modifications necessary except for native applications that require a specified culture.</span></span> |
| <span data-ttu-id="028db-351">**互換性のために残されているカルチャ タイプ**</span><span class="sxs-lookup"><span data-stu-id="028db-351">**Obsolete culture types**</span></span> | <span data-ttu-id="028db-352"><xref:System.Globalization.CultureTypes> と <xref:System.Globalization.CultureTypes> のカルチャ タイプは互換性のために残されています。</span><span class="sxs-lookup"><span data-stu-id="028db-352">The <xref:System.Globalization.CultureTypes> and <xref:System.Globalization.CultureTypes> culture types are now obsolete.</span></span><br><br><span data-ttu-id="028db-353">下位互換性を維持するために、<xref:System.Globalization.CultureTypes> は以前の .NET Framework に含まれていたニュートラル カルチャと特定のカルチャを返し、<xref:System.Globalization.CultureTypes> は空のリストを返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-353">For backward compatibility, <xref:System.Globalization.CultureTypes> now returns neutral and specific cultures that were included with the previous .NET Framework, and <xref:System.Globalization.CultureTypes> now returns an empty list.</span></span> | <span data-ttu-id="028db-354"><xref:System.Globalization.CultureTypes> 列挙の他の値を使用します。</span><span class="sxs-lookup"><span data-stu-id="028db-354">Use other values of the <xref:System.Globalization.CultureTypes> enumeration.</span></span> |
| <span data-ttu-id="028db-355">**カルチャの取得**</span><span class="sxs-lookup"><span data-stu-id="028db-355">**Retrieving culture**</span></span> | <span data-ttu-id="028db-356">Windows 7 以降、.NET Framework 4 ではデータ自体を格納する代わりにオペレーティング システムからカルチャ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="028db-356">Beginning with Windows 7, the .NET Framework 4 retrieves culture information from the operating system instead of storing the data itself.</span></span> <span data-ttu-id="028db-357">また、.NET Framework では、データの並べ替えおよび大文字と小文字の指定を行うために Windows と同期します。</span><span class="sxs-lookup"><span data-stu-id="028db-357">In addition, the .NET Framework synchronizes with Windows for sorting and casing data.</span></span> | <span data-ttu-id="028db-358">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-358">None.</span></span> |
| <span data-ttu-id="028db-359">**Unicode 5.1 規格**</span><span class="sxs-lookup"><span data-stu-id="028db-359">**Unicode 5.1 standards**</span></span> | <span data-ttu-id="028db-360">.NET Framework では、すべての Unicode 5.1 文字がサポートされるようになり、約 1400 文字が追加されました。</span><span class="sxs-lookup"><span data-stu-id="028db-360">The .NET Framework now supports all Unicode 5.1 characters -- an addition of approximately 1400 characters.</span></span> <span data-ttu-id="028db-361">追加された文字には、新しい記号、矢印、分音記号、句読点、算術記号、CJK ストローク、漢字、追加のマラヤラム文字、テルグ語の数字、ミャンマー語、ラテン語、アラビア語、ギリシャ語、モンゴル語、キリル語の文字などがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-361">The additional characters include new symbols, arrows, diacritics, punctuation, mathematical symbols, CJK strokes and ideographs, additional Malayalam and Telugu numeric characters, and various Myanmar, Latin, Arabic, Greek, Mongolian, and Cyrillic characters.</span></span> <span data-ttu-id="028db-362">Unicode 5.1 では、次のスクリプトが新たにサポートされています: スンダ文字、レプチャ文字、オル チキ文字、ヴァイ文字、サウラーシュトラー文字、カヤーリー文字、ルジャン文字、グルムキー文字、オリヤー文字、タミール文字、テルグ文字、マラヤラム文字、チャム文字。</span><span class="sxs-lookup"><span data-stu-id="028db-362">The following new scripts are supported with Unicode 5.1: Sundanese, Lepcha, Ol Chiki, Vai, Saurashtra, Kayah Li, Rejang, Gurmukhi, Odia, Tamil, Telugu, and Malayalam characters and Cham.</span></span> | <span data-ttu-id="028db-363">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-363">None.</span></span> |

### <a name="exceptions"></a><span data-ttu-id="028db-364">例外</span><span class="sxs-lookup"><span data-stu-id="028db-364">Exceptions</span></span>

<span data-ttu-id="028db-365">名前空間: <xref:System>、<xref:System.Runtime.ExceptionServices>。アセンブリ: mscorlib (mscorlib.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-365">Namespaces: <xref:System>, <xref:System.Runtime.ExceptionServices>; assembly: mscorlib (in mscorlib.dll)</span></span>

| <span data-ttu-id="028db-366">機能</span><span class="sxs-lookup"><span data-stu-id="028db-366">Feature</span></span> | <span data-ttu-id="028db-367">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-367">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-368">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-368">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-369">**破損したプロセスの状態に対する例外**</span><span class="sxs-lookup"><span data-stu-id="028db-369">**Exceptions for corrupted process state**</span></span> | <span data-ttu-id="028db-370">CLR は、破損したプロセス状態に対する例外をマネージド コード内の例外ハンドラーに伝達しなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-370">The CLR no longer delivers exceptions for corrupted process state to exception handlers in managed code.</span></span> | <span data-ttu-id="028db-371">これらの例外は、プロセスの状態が破損していることを示します。</span><span class="sxs-lookup"><span data-stu-id="028db-371">These exceptions indicate that the state of a process has been corrupted.</span></span> <span data-ttu-id="028db-372">この状態にあるアプリケーションの実行はお勧めしません。</span><span class="sxs-lookup"><span data-stu-id="028db-372">We do not recommend that you run your application in this state.</span></span><br><br><span data-ttu-id="028db-373">詳細については、「<xref:System.Runtime.ExceptionServices.HandleProcessCorruptedStateExceptionsAttribute>」と、CLR 徹底解剖ブログの「[破損状態例外を処理する](https://go.microsoft.com/fwlink/?LinkID=179681)」エントリをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="028db-373">For more information, see the <xref:System.Runtime.ExceptionServices.HandleProcessCorruptedStateExceptionsAttribute> and the entry [Handling Corrupted State Exceptions](https://go.microsoft.com/fwlink/?LinkID=179681) in the CLR Inside Out blog.</span></span> |
| <span data-ttu-id="028db-374">**実行エンジンの例外**</span><span class="sxs-lookup"><span data-stu-id="028db-374">**Execution engine exceptions**</span></span> | <span data-ttu-id="028db-375">キャッチ可能な例外によって不安定なプロセスが実行を継続できるため、<xref:System.ExecutionEngineException> は廃止されました。</span><span class="sxs-lookup"><span data-stu-id="028db-375"><xref:System.ExecutionEngineException> is now obsolete, because a catchable exception will allow an unstable process to continue to run.</span></span> <span data-ttu-id="028db-376">この変更により、実行時の予測可能性と信頼性が向上しました。</span><span class="sxs-lookup"><span data-stu-id="028db-376">This change improves predictability and reliability in the runtime.</span></span> | <span data-ttu-id="028db-377">状況を通知するには <xref:System.InvalidOperationException> を使用します。</span><span class="sxs-lookup"><span data-stu-id="028db-377">Use an <xref:System.InvalidOperationException> to signal the condition.</span></span> |

### <a name="reflection"></a><span data-ttu-id="028db-378">リフレクション</span><span class="sxs-lookup"><span data-stu-id="028db-378">Reflection</span></span>

<span data-ttu-id="028db-379">名前空間: <xref:System.Reflection>。アセンブリ: mscorlib (mscorlib.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-379">Namespace: <xref:System.Reflection>; assembly: mscorlib (in mscorlib.dll)</span></span>

| <span data-ttu-id="028db-380">機能</span><span class="sxs-lookup"><span data-stu-id="028db-380">Feature</span></span> | <span data-ttu-id="028db-381">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-381">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-382">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-382">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-383">**アセンブリ ハッシュ アルゴリズム**</span><span class="sxs-lookup"><span data-stu-id="028db-383">**Assembly hash algorithms**</span></span> | <span data-ttu-id="028db-384">ランタイムはアセンブリが読み込まれていない場合に参照アセンブリのハッシュ アルゴリズムがわからないため、<xref:System.Reflection.AssemblyName.HashAlgorithm> プロパティは <xref:System.Configuration.Assemblies.AssemblyHashAlgorithm> を返すようになりました </span><span class="sxs-lookup"><span data-stu-id="028db-384">The <xref:System.Reflection.AssemblyName.HashAlgorithm> property now returns <xref:System.Configuration.Assemblies.AssemblyHashAlgorithm>, because the runtime does not know the hash algorithm of the referenced assembly when the assembly is not loaded.</span></span> <span data-ttu-id="028db-385">(これは、<xref:System.Reflection.Assembly.GetReferencedAssemblies%2A> メソッドによって返されるような参照アセンブリのプロパティの使用を意味します)。</span><span class="sxs-lookup"><span data-stu-id="028db-385">(This refers to using the property on a referenced assembly such as that returned by the <xref:System.Reflection.Assembly.GetReferencedAssemblies%2A> method.)</span></span> | <span data-ttu-id="028db-386">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-386">None.</span></span> |
| <span data-ttu-id="028db-387">**アセンブリの読み込み**</span><span class="sxs-lookup"><span data-stu-id="028db-387">**Assembly loading**</span></span> | <span data-ttu-id="028db-388">アセンブリの冗長な読み込みを防ぎ、仮想アドレス空間を節約するために、CLR は Win32 `MapViewOfFile` 関数のみを使用してアセンブリを読み込むようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-388">To prevent redundant loading of assemblies and to save virtual address space, the CLR now loads assemblies by using only the Win32 `MapViewOfFile` function.</span></span> <span data-ttu-id="028db-389">また、`LoadLibrary` 関数も呼び出さなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-389">It no longer also calls the `LoadLibrary` function.</span></span><br><br><span data-ttu-id="028db-390">この変更によって、診断アプリケーションは次のような影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="028db-390">This change affects diagnostic applications in the following ways:</span></span><br><br><span data-ttu-id="028db-391">\* <xref:System.Diagnostics.ProcessModuleCollection> は、クラス ライブラリ (.dll ファイル) のモジュールを含まなくなりました。これらのモジュールは `Process.GetCurrentProcess().Modules` の呼び出しから取得されるためです。</span><span class="sxs-lookup"><span data-stu-id="028db-391">\* A <xref:System.Diagnostics.ProcessModuleCollection> will no longer contain any modules from a class library (.dll file), as obtained from a call to `Process.GetCurrentProcess().Modules`.</span></span><br><span data-ttu-id="028db-392">\* `EnumProcessModules` 関数を使用する Win32 アプリケーションは、一覧にあるすべてのマネージド モジュールを参照することはなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-392">\* Win32 applications that use the `EnumProcessModules` function will not see all managed modules listed.</span></span> | <span data-ttu-id="028db-393">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-393">None.</span></span> |
| <span data-ttu-id="028db-394">**宣言する型**</span><span class="sxs-lookup"><span data-stu-id="028db-394">**Declaring type**</span></span> | <span data-ttu-id="028db-395"><xref:System.Type.DeclaringType> プロパティは、宣言する型を持たない場合に null を正しく返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-395">The <xref:System.Type.DeclaringType> property now correctly returns null when the type does not have a declaring type.</span></span> | <span data-ttu-id="028db-396">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-396">None.</span></span> |
| <span data-ttu-id="028db-397">**デリゲート**</span><span class="sxs-lookup"><span data-stu-id="028db-397">**Delegates**</span></span> | <span data-ttu-id="028db-398">デリゲートは、デリゲートのコンストラクターに null 値が渡された場合に、<xref:System.NullReferenceException> ではなく <xref:System.ArgumentNullException> をスローするようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-398">A delegate now throws an <xref:System.ArgumentNullException> instead of a <xref:System.NullReferenceException> when a null value is passed to the delegate's constructor.</span></span> | <span data-ttu-id="028db-399">例外処理が <xref:System.ArgumentNullException> をキャッチすることを確認します。</span><span class="sxs-lookup"><span data-stu-id="028db-399">Ensure that any exception handling catches <xref:System.ArgumentNullException>.</span></span> |
| <span data-ttu-id="028db-400">**グローバル アセンブリ キャッシュの場所の変更**</span><span class="sxs-lookup"><span data-stu-id="028db-400">**Global assembly cache location change**</span></span> | <span data-ttu-id="028db-401">.NET Framework 4 アセンブリでは、グローバル アセンブリ キャッシュは Windows ディレクトリ (%WINDIR%) から Microsoft .NET サブディレクトリ (*%WINDIR%\\Microsoft.Net*) に移動しました。</span><span class="sxs-lookup"><span data-stu-id="028db-401">For .NET Framework 4 assemblies, the global assembly cache has been moved from the Windows directory (%WINDIR%) to the Microsoft.Net subdirectory (*%WINDIR%\\Microsoft.Net*).</span></span> <span data-ttu-id="028db-402">旧バージョンのアセンブリは以前のディレクトリに残っています。</span><span class="sxs-lookup"><span data-stu-id="028db-402">Assemblies from earlier versions remain in the older directory.</span></span><br><br><span data-ttu-id="028db-403">アンマネージ [ASM_CACHE_FLAGS](../unmanaged-api/fusion/asm-cache-flags-enumeration.md) 列挙には、新しい `ASM_CACHE_ROOT_EX` フラグが含まれています。</span><span class="sxs-lookup"><span data-stu-id="028db-403">The unmanaged [ASM_CACHE_FLAGS](../unmanaged-api/fusion/asm-cache-flags-enumeration.md) enumeration contains the new `ASM_CACHE_ROOT_EX` flag.</span></span> <span data-ttu-id="028db-404">このフラグによって、[GetCachePath](../unmanaged-api/fusion/getcachepath-function.md) 関数で取得できる .NET Framework 4 アセンブリのキャッシュ場所が取得されます。</span><span class="sxs-lookup"><span data-stu-id="028db-404">This flag gets the cache location for .NET Framework 4 assemblies, which can be obtained by the [GetCachePath](../unmanaged-api/fusion/getcachepath-function.md) function.</span></span> | <span data-ttu-id="028db-405">なし。アプリケーションがアセンブリへの明示的なパスを使用しないことを想定しており、パスの使用は推奨されていません。</span><span class="sxs-lookup"><span data-stu-id="028db-405">None, assuming that applications do not use explicit paths to assemblies, which is not a recommended practice.</span></span> |
| <span data-ttu-id="028db-406">**グローバル アセンブリ キャッシュ ツール**</span><span class="sxs-lookup"><span data-stu-id="028db-406">**Global assembly cache tool**</span></span> | <span data-ttu-id="028db-407">[Gacutil.exe (グローバル アセンブリ キャッシュ ツール)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ex0ss12c%28v=vs.100%29) は、シェル プラグイン ビューアーをサポートしなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-407">The [Gacutil.exe (Global Assembly Cache Tool)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ex0ss12c%28v=vs.100%29) no longer supports the shell plugin viewer.</span></span> | <span data-ttu-id="028db-408">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-408">None.</span></span> |

### <a name="interoperability"></a><span data-ttu-id="028db-409">相互運用性</span><span class="sxs-lookup"><span data-stu-id="028db-409">Interoperability</span></span>

<span data-ttu-id="028db-410">名前空間: <xref:System.Runtime.InteropServices>。アセンブリ: mscorlib (mscorlib.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-410">Namespace: <xref:System.Runtime.InteropServices>; assembly: mscorlib (in mscorlib.dll)</span></span>

| <span data-ttu-id="028db-411">機能</span><span class="sxs-lookup"><span data-stu-id="028db-411">Feature</span></span> | <span data-ttu-id="028db-412">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-412">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-413">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-413">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-414">**バッファーの長さ** (アンマネージ API)</span><span class="sxs-lookup"><span data-stu-id="028db-414">**Buffer length** (unmanaged API)</span></span> | <span data-ttu-id="028db-415">メモリを節約するために、[ICorProfilerInfo2::GetStringLayout](../unmanaged-api/profiling/icorprofilerinfo2-getstringlayout-method.md) メソッドの `pBufferLengthOffset` パラメーターの機能は、`pStringLengthOffset` パラメーターと一致するように変更されました。</span><span class="sxs-lookup"><span data-stu-id="028db-415">To save memory, the functionality for the `pBufferLengthOffset` parameter for the [ICorProfilerInfo2::GetStringLayout](../unmanaged-api/profiling/icorprofilerinfo2-getstringlayout-method.md) method has been changed to match the `pStringLengthOffset` parameter.</span></span> <span data-ttu-id="028db-416">両方のパラメーターが文字列の長さのオフセット位置を指すようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-416">Both parameters now point to the offset location of the string's length.</span></span> <span data-ttu-id="028db-417">バッファーの長さは、文字列クラスの表現から削除されました。</span><span class="sxs-lookup"><span data-stu-id="028db-417">Buffer length has been removed from the representation of the string class.</span></span> | <span data-ttu-id="028db-418">バッファーの長さへの依存を除去します。</span><span class="sxs-lookup"><span data-stu-id="028db-418">Remove any dependency on the buffer length.</span></span> |
| <span data-ttu-id="028db-419">**JIT デバッグ**</span><span class="sxs-lookup"><span data-stu-id="028db-419">**JIT debugging**</span></span> | <span data-ttu-id="028db-420">Just-In-Time (JIT) デバッグの登録を簡略化するために、.NET Framework デバッガーは、ネイティブ コードの JIT デバッグの動作を制御する AeDebug レジストリ キーのみを使用するようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-420">To simplify registration for just-in-time (JIT) debugging, the .NET Framework debugger now uses only the AeDebug registry key, which controls the JIT debugging behavior for native code.</span></span> <span data-ttu-id="028db-421">この変更の結果は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="028db-421">This change results in the following:</span></span><br><br><span data-ttu-id="028db-422">\* マネージド コードとネイティブ コードに 2 つの異なるデバッガーを登録することはできなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-422">\* You can no longer register two different debuggers for managed and native code.</span></span><br><span data-ttu-id="028db-423">\* 非対話形式のプロセスに対してデバッガーを自動的に開始することはできなくなりましたが、対話形式のプロセスについてはユーザーにプロンプトを表示できます。</span><span class="sxs-lookup"><span data-stu-id="028db-423">\* You can no longer start the debugger automatically for a non-interactive process, but you can prompt the user for an interactive process.</span></span><br><span data-ttu-id="028db-424">\* デバッガーの起動に失敗した場合、または起動する必要のある登録済みデバッガーがない場合は、通知が行われなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-424">\* You are no longer notified when the debugger fails to start, or when there is no registered debugger that should be started.</span></span><br><span data-ttu-id="028db-425">\* アプリケーションの対話機能に依存する自動起動ポリシーは、サポートされなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-425">\* Auto-launch policies that depend on the interactivity of the application are no longer supported.</span></span> | <span data-ttu-id="028db-426">必要に応じてデバッグ操作を調整します。</span><span class="sxs-lookup"><span data-stu-id="028db-426">Adjust debugging operations as required.</span></span> |
| <span data-ttu-id="028db-427">**プラットフォーム呼び出し**</span><span class="sxs-lookup"><span data-stu-id="028db-427">**Platform invoke**</span></span> | <span data-ttu-id="028db-428">アンマネージ コードとの相互運用性のパフォーマンスを向上させるために、プラットフォーム呼び出しに不適切な呼び出し規約があると、アプリケーションが失敗するようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-428">To improve performance in interoperability with unmanaged code, incorrect calling conventions in a platform invoke now cause the application to fail.</span></span> <span data-ttu-id="028db-429">以前のバージョンでは、マーシャリング レイヤーがスタック上でこれらのエラーを解決しました。</span><span class="sxs-lookup"><span data-stu-id="028db-429">In previous versions, the marshaling layer resolved these errors up the stack.</span></span> | <span data-ttu-id="028db-430">Microsoft Visual Studio でアプリケーションをデバッグすると、これらのエラーが警告されるため、エラーを修正できます。</span><span class="sxs-lookup"><span data-stu-id="028db-430">Debugging your applications in Microsoft Visual Studio alerts you to these errors so you can correct them.</span></span><br><br><span data-ttu-id="028db-431">更新できないバイナリがある場合は、アプリケーションの構成ファイルに [\<NetFx40_PInvokeStackResilience](../configure-apps/file-schema/runtime/netfx40-pinvokestackresilience-element.md) 要素を含めて、以前のバージョンのように呼び出しエラーを 1 つずつ解決できるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="028db-431">If you have binaries that cannot be updated, you can include the [\<NetFx40_PInvokeStackResilience>](../configure-apps/file-schema/runtime/netfx40-pinvokestackresilience-element.md) element in your application's configuration file to enable calling errors to be resolved up the stack as in earlier versions.</span></span> <span data-ttu-id="028db-432">ただし、この処理はアプリケーションのパフォーマンスに影響することがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-432">However, this may affect the performance of your application.</span></span> |
| <span data-ttu-id="028db-433">**削除されたインターフェイス** (アンマネージ API)</span><span class="sxs-lookup"><span data-stu-id="028db-433">**Removed interfaces** (unmanaged API)</span></span> | <span data-ttu-id="028db-434">開発者の混乱を避けるために、次のインターフェイスが削除されました。これらのインターフェイスで有用な実行時シナリオが提供されることはなく、CLR でも実装の提供または受け入れを行っていなかったためです。</span><span class="sxs-lookup"><span data-stu-id="028db-434">To avoid developer confusion, the following interfaces were removed, because they did not provide any useful run-time scenarios, and the CLR did not provide or accept any implementations:</span></span><br><br><span data-ttu-id="028db-435">\* **INativeImageINativeImageDependency**</span><span class="sxs-lookup"><span data-stu-id="028db-435">\* **INativeImageINativeImageDependency**</span></span><br><span data-ttu-id="028db-436">\* **INativeImageInstallInfo**</span><span class="sxs-lookup"><span data-stu-id="028db-436">\* **INativeImageInstallInfo**</span></span><br><span data-ttu-id="028db-437">\* **INativeImageEvaluate**</span><span class="sxs-lookup"><span data-stu-id="028db-437">\* **INativeImageEvaluate**</span></span><br><span data-ttu-id="028db-438">\* **INativeImageConverter**</span><span class="sxs-lookup"><span data-stu-id="028db-438">\* **INativeImageConverter**</span></span><br><span data-ttu-id="028db-439">\* **ICorModule**</span><span class="sxs-lookup"><span data-stu-id="028db-439">\* **ICorModule**</span></span><br><span data-ttu-id="028db-440">\* **IMetaDataConverter**</span><span class="sxs-lookup"><span data-stu-id="028db-440">\* **IMetaDataConverter**</span></span> | <span data-ttu-id="028db-441">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-441">None.</span></span> |

## <a name="data"></a><span data-ttu-id="028db-442">データ</span><span class="sxs-lookup"><span data-stu-id="028db-442">Data</span></span>

<span data-ttu-id="028db-443">このセクションでは、データ セットと SQL クライアント、Entity Framework、LINQ to SQL、WCF Data Services (以前の ADO.NET Data Services) を使用するための移行に関する問題について説明します。</span><span class="sxs-lookup"><span data-stu-id="028db-443">This section describes migration issues for using data sets and SQL clients, the Entity Framework, LINQ to SQL, and WCF Data Servers (formerly known as ADO.NET Data Services).</span></span>

### <a name="dataset-and-sql-client"></a><span data-ttu-id="028db-444">データセットと SQL クライアント</span><span class="sxs-lookup"><span data-stu-id="028db-444">DataSet and SQL Client</span></span>

<span data-ttu-id="028db-445">次の表に、以前は制限やその他の問題があった機能に対する改善点を示します。</span><span class="sxs-lookup"><span data-stu-id="028db-445">The following table describes improvements to features that previously had limitations or other issues.</span></span>

<span data-ttu-id="028db-446">名前空間: <xref:System.Data>、<xref:System.Data.Objects.DataClasses>、<xref:System.Data.SqlClient>。アセンブリ: System.Data (System.Data.dll 内)、System.Data.Entity (System.Data.Entity.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-446">Namespaces: <xref:System.Data>, <xref:System.Data.Objects.DataClasses>, <xref:System.Data.SqlClient>; assemblies: System.Data (in System.Data.dll), System.Data.Entity (in System.Data.Entity.dll)</span></span>

| <span data-ttu-id="028db-447">機能</span><span class="sxs-lookup"><span data-stu-id="028db-447">Feature</span></span> | <span data-ttu-id="028db-448">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-448">Differences from 3.5 SP1</span></span> |
| ------- | ------------------------ |
| <span data-ttu-id="028db-449">**POCO のシナリオ**</span><span class="sxs-lookup"><span data-stu-id="028db-449">**POCO Scenarios**</span></span> | <span data-ttu-id="028db-450"><xref:System.Data.Objects.DataClasses.IRelatedEnd> インターフェイスには、単純な従来の CLR オブジェクト (POCO) シナリオでのその使用性を向上させる新しいメソッドがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-450">The <xref:System.Data.Objects.DataClasses.IRelatedEnd> interface has new methods to improve its usability in Plain Old CLR Object (POCO) scenarios.</span></span> <span data-ttu-id="028db-451">これらの新しいメソッドは、<xref:System.Data.Objects.DataClasses.IEntityWithRelationships> エンティティではなく <xref:System.Object> をパラメーターとして受け取ります。</span><span class="sxs-lookup"><span data-stu-id="028db-451">These new methods take an <xref:System.Object> instead of an <xref:System.Data.Objects.DataClasses.IEntityWithRelationships> entity as a parameter.</span></span> |
| <span data-ttu-id="028db-452">**行の編集**</span><span class="sxs-lookup"><span data-stu-id="028db-452">**Editing Rows**</span></span> | <span data-ttu-id="028db-453"><xref:System.Data.DataView> クラスで実装されているような <xref:System.Collections.IList.IndexOf%2A> メソッドは、-1 を返す代わりに、編集されている行の値を正しく返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-453">The <xref:System.Collections.IList.IndexOf%2A> method, as implemented by the <xref:System.Data.DataView> class, now correctly returns the value of a row that is being edited, instead of returning -1.</span></span> |
| <span data-ttu-id="028db-454">**イベント**</span><span class="sxs-lookup"><span data-stu-id="028db-454">**Events**</span></span> | <span data-ttu-id="028db-455"><xref:System.Data.DataRowView.PropertyChanged> イベントは、行が変更された状態になり <xref:System.Data.DataRow.RejectChanges%2A> メソッドが呼び出されたときに、発生するようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-455">The <xref:System.Data.DataRowView.PropertyChanged> event is now raised when a row is in a modified state and the <xref:System.Data.DataRow.RejectChanges%2A> method is called.</span></span> <span data-ttu-id="028db-456">この変更により、<xref:System.Data.DataSet> オブジェクトの内容を公開する UI コントロールの作成が簡単になります。</span><span class="sxs-lookup"><span data-stu-id="028db-456">This change makes it easier to create UI controls that expose the contents of a <xref:System.Data.DataSet> object.</span></span> |
| <span data-ttu-id="028db-457">**例外**</span><span class="sxs-lookup"><span data-stu-id="028db-457">**Exceptions**</span></span> | <span data-ttu-id="028db-458"><xref:System.Data.SqlClient.SqlCommand.Prepare%2A> メソッドは、接続が設定されていない、または開いていないときに、<xref:System.NullReferenceException> ではなく <xref:System.InvalidOperationException> をスローするようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-458">The <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> method now throws an <xref:System.InvalidOperationException> when a connection is not set or open instead of a <xref:System.NullReferenceException>.</span></span> |
| <span data-ttu-id="028db-459">**ビューのマッピング**</span><span class="sxs-lookup"><span data-stu-id="028db-459">**Mapping Views**</span></span> | <span data-ttu-id="028db-460">実行時に <xref:System.NullReferenceException> をスローする代わりに、デザイン時にクエリ ビュー マッピング エラーがキャッチされるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-460">Query view mapping errors are now caught at design time instead of throwing a <xref:System.NullReferenceException> at run time.</span></span><br><br><span data-ttu-id="028db-461">マッピングの検証は、概念スキーマ (CSDL) 内の 2 つの関連付けセットが同じ列にマッピングされているエラーをキャッチするようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-461">Mapping validation now catches the error in which two association sets in Conceptual Schema (CSDL) are mapped to the same column.</span></span> |
| <span data-ttu-id="028db-462">**トランザクション**</span><span class="sxs-lookup"><span data-stu-id="028db-462">**Transactions**</span></span> | <span data-ttu-id="028db-463">トランザクションの完了後 (中止またはロールバックを含む)、アプリケーションが接続に対してステートメントを実行しようとした場合に、<xref:System.InvalidOperationException> がスローされるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-463">If an application tries to execute a statement on a connection after a transaction has been completed (including aborted or rolled back), an <xref:System.InvalidOperationException> is now thrown.</span></span> <span data-ttu-id="028db-464">以前のバージョンでは、例外がスローされず、トランザクションが中止された場合でも追加のコマンドを実行できました。</span><span class="sxs-lookup"><span data-stu-id="028db-464">Previous versions did not throw an exception and let you execute additional commands even if a transaction was aborted.</span></span> |

### <a name="entity-framework"></a><span data-ttu-id="028db-465">Entity Framework</span><span class="sxs-lookup"><span data-stu-id="028db-465">Entity Framework</span></span>

<span data-ttu-id="028db-466">次の表に、以前は制限やその他の問題があった機能に対する改善点を示します。</span><span class="sxs-lookup"><span data-stu-id="028db-466">The following table describes improvements to features that previously had limitations or other issues.</span></span>

<span data-ttu-id="028db-467">名前空間: <xref:System.Data>、<xref:System.Data.Objects>、<xref:System.Data.Objects.DataClasses>。アセンブリ: System.Data.Entity (System.Data.Entity.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-467">Namespaces: <xref:System.Data>, <xref:System.Data.Objects>, <xref:System.Data.Objects.DataClasses>; assembly: System.Data.Entity (in System.Data.Entity.dll)</span></span>

| <span data-ttu-id="028db-468">機能</span><span class="sxs-lookup"><span data-stu-id="028db-468">Feature</span></span> | <span data-ttu-id="028db-469">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-469">Differences from 3.5 SP1</span></span> |
| ------- | ------------------------ |
| <span data-ttu-id="028db-470">**エンティティ オブジェクト**</span><span class="sxs-lookup"><span data-stu-id="028db-470">**Entity objects**</span></span> | <span data-ttu-id="028db-471"><xref:System.Data.Objects.ObjectContext.SaveChanges%2A> メソッドが呼び出された場合、現在は <xref:System.Data.Objects.ObjectContext.Detach%2A> メソッドとエンティティ オブジェクトの状態の間にパリティがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-471">There is now parity between the <xref:System.Data.Objects.ObjectContext.Detach%2A> method and the state of the entity object when the <xref:System.Data.Objects.ObjectContext.SaveChanges%2A> method is called.</span></span> <span data-ttu-id="028db-472">この一貫性の向上により、予期しない例外がスローされなくなります。</span><span class="sxs-lookup"><span data-stu-id="028db-472">This improved consistency prevents unexpected exceptions from being thrown.</span></span> |
| <span data-ttu-id="028db-473">**Entity SQL**</span><span class="sxs-lookup"><span data-stu-id="028db-473">**Entity SQL**</span></span> | <span data-ttu-id="028db-474">Entity SQL の識別子解決の規則が改善されました。</span><span class="sxs-lookup"><span data-stu-id="028db-474">Rules have been improved for identifier resolutions in Entity SQL.</span></span><br><br><span data-ttu-id="028db-475">Entity SQL パーサーで、マルチパート識別子の解決ロジックが改善されました。</span><span class="sxs-lookup"><span data-stu-id="028db-475">The Entity SQL parser has improved logic for resolving multipart identifiers.</span></span> |
| <span data-ttu-id="028db-476">**構造的な注釈**</span><span class="sxs-lookup"><span data-stu-id="028db-476">**Structural annotations**</span></span> | <span data-ttu-id="028db-477">Entity Framework は、構造的な注釈を認識するようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-477">The Entity Framework now recognizes structural annotations.</span></span> |
| <span data-ttu-id="028db-478">**クエリ**</span><span class="sxs-lookup"><span data-stu-id="028db-478">**Queries**</span></span> | <span data-ttu-id="028db-479">クエリでは次の改良が行われました。</span><span class="sxs-lookup"><span data-stu-id="028db-479">The following improvements were made in queries:</span></span><br><br><span data-ttu-id="028db-480">\* 空のコレクションに対する null キーを使用した `GroupBy` クエリは、クエリに追加の選択があるかどうかにかかわらず、行を返しません。</span><span class="sxs-lookup"><span data-stu-id="028db-480">\* A `GroupBy` query using a null key over an empty collection will not return any rows, regardless if there are any additional selects in the query.</span></span><br><span data-ttu-id="028db-481">\* LINQ および Entity-SQL クエリで生成された SQL は、文字列パラメーターを既定で非 Unicode 値として扱うようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-481">\* Generated SQL in LINQ and Entity-SQL queries now treat string parameters as non-Unicode values by default.</span></span> |

### <a name="linq-to-sql"></a><span data-ttu-id="028db-482">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="028db-482">LINQ to SQL</span></span>

<span data-ttu-id="028db-483">次の表に、以前は制限やその他の問題があった機能に対する改善点を示します。</span><span class="sxs-lookup"><span data-stu-id="028db-483">The following table describes improvements to features that previously had limitations or other issues.</span></span>

<span data-ttu-id="028db-484">名前空間: <xref:System.Data.Linq>。アセンブリ: System.Data.Linq (System.Data.Linq.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-484">Namespace: <xref:System.Data.Linq>; assembly: System.Data.Linq (in System.Data.Linq.dll)</span></span>

| <span data-ttu-id="028db-485">機能</span><span class="sxs-lookup"><span data-stu-id="028db-485">Feature</span></span> | <span data-ttu-id="028db-486">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-486">Differences from 3.5 SP1</span></span> |
| ------- | ------------------------ |
| <span data-ttu-id="028db-487">**イベント**</span><span class="sxs-lookup"><span data-stu-id="028db-487">**Events**</span></span> | <span data-ttu-id="028db-488"><xref:System.Data.Linq.EntitySet%601> コレクションは、コレクションが読み込まれたときのイベントの生成に加えて、<xref:System.Data.Linq.EntitySet%601> がアンロードされている場合に追加操作と削除操作に対して <xref:System.Data.Linq.EntitySet%601.ListChanged> イベントを生成するようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-488">A <xref:System.Data.Linq.EntitySet%601> collection now raises the <xref:System.Data.Linq.EntitySet%601.ListChanged> event for add and remove operations if the <xref:System.Data.Linq.EntitySet%601> is unloaded, in addition to raising the event when the collection is loaded.</span></span> |
| <span data-ttu-id="028db-489">**クエリ**</span><span class="sxs-lookup"><span data-stu-id="028db-489">**Queries**</span></span> | <span data-ttu-id="028db-490">`Skip(0)` は、LINQ to SQL クエリでは無視されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-490">`Skip(0)` is no longer ignored in LINQ to SQL queries.</span></span> <span data-ttu-id="028db-491">その結果、このメソッドを含むクエリの動作が変わる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="028db-491">As a result, queries that have this method might behave differently.</span></span> <span data-ttu-id="028db-492">たとえば、場合によっては、`OrderBy` 句が `Skip(0)` で必要になり、`OrderBy` 句が含まれていないと <xref:System.NotSupportedException> 例外がクエリからスローされるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-492">For example in some cases, an `OrderBy` clause is required with `Skip(0)`, and the query will now throw a <xref:System.NotSupportedException> exception if the `OrderBy` clause was not included.</span></span> |

### <a name="wcf-data-services"></a><span data-ttu-id="028db-493">WCF Data Services</span><span class="sxs-lookup"><span data-stu-id="028db-493">WCF Data Services</span></span>

<span data-ttu-id="028db-494">次の表に、以前は制限やその他の問題があった機能に対する改善点を示します。</span><span class="sxs-lookup"><span data-stu-id="028db-494">The following table describes improvements to features that previously had limitations or other issues.</span></span>

<span data-ttu-id="028db-495">名前空間: <xref:System.Data.Services>、<xref:System.Data.Services.Client>、<xref:System.Data.Services.Common>、<xref:System.Data.Services.Providers>。アセンブリ: System.Data.Services (System.Data.Services.dll 内)、System.Data.Services.Client (System.Data.Services.Client.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-495">Namespaces: <xref:System.Data.Services>, <xref:System.Data.Services.Client>, <xref:System.Data.Services.Common>, <xref:System.Data.Services.Providers>; assemblies: System.Data.Services (in System.Data.Services.dll), System.Data.Services.Client (in System.Data.Services.Client.dll)</span></span>

| <span data-ttu-id="028db-496">機能</span><span class="sxs-lookup"><span data-stu-id="028db-496">Feature</span></span> | <span data-ttu-id="028db-497">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-497">Differences from 3.5 SP1</span></span> |
| ------- | ------------------------ |
| <span data-ttu-id="028db-498">**バッチ バイナリ コンテンツ**</span><span class="sxs-lookup"><span data-stu-id="028db-498">**Batched Binary Content**</span></span> | <span data-ttu-id="028db-499">WCF Data Services では、要求と応答でバッチ バイナリ コンテンツをサポートするようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-499">WCF Data Services now supports batched binary content in requests and responses.</span></span> |
| <span data-ttu-id="028db-500">**変更インターセプター**</span><span class="sxs-lookup"><span data-stu-id="028db-500">**Change interceptors**</span></span> | <span data-ttu-id="028db-501">変更インターセプターが、削除要求に対して実行されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-501">Change interceptors are now executed for a delete request.</span></span><br><br><span data-ttu-id="028db-502">変更インターセプターは、エンティティ セット内のエンティティを変更する要求がサーバーによって受信されるたびに実行されるメソッドです。</span><span class="sxs-lookup"><span data-stu-id="028db-502">A change interceptor is a method that runs every time a request is received by the server to modify an entity in the entity set.</span></span> <span data-ttu-id="028db-503">実行されると、受信した要求が実行されます。</span><span class="sxs-lookup"><span data-stu-id="028db-503">It runs before the incoming request is executed.</span></span> <span data-ttu-id="028db-504">変更インターセプターは、変更されるエンティティとそのエンティティに対して実行される操作へのアクセスを可能にします。</span><span class="sxs-lookup"><span data-stu-id="028db-504">The change interceptor provides access to the entity that is being changed and the operation that is being performed on it.</span></span> |
| <span data-ttu-id="028db-505">**例外**</span><span class="sxs-lookup"><span data-stu-id="028db-505">**Exceptions**</span></span> | <span data-ttu-id="028db-506">次の条件では、<xref:System.NullReferenceException> ではなく、より役に立つ例外がスローされるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-506">The following conditions now throw more useful exceptions instead of a <xref:System.NullReferenceException>:</span></span><br><br><span data-ttu-id="028db-507">\* データ サービスの呼び出しがタイムアウトになった場合の <xref:System.ServiceProcess.TimeoutException>。</span><span class="sxs-lookup"><span data-stu-id="028db-507">\* A <xref:System.ServiceProcess.TimeoutException> when a call to a data service times out.</span></span><br><span data-ttu-id="028db-508">\* データ サービスに対して不適切な要求が行われた場合の <xref:System.Data.Services.Client.DataServiceRequestException>。</span><span class="sxs-lookup"><span data-stu-id="028db-508">\* A <xref:System.Data.Services.Client.DataServiceRequestException> when a bad request is made to a data service.</span></span><br><br><span data-ttu-id="028db-509">アプリケーションでは、新しい例外をキャッチするように例外処理を変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="028db-509">In your applications, you should change exception handling to catch the new exceptions.</span></span> |
| <span data-ttu-id="028db-510">**ヘッダー**</span><span class="sxs-lookup"><span data-stu-id="028db-510">**Headers**</span></span> | <span data-ttu-id="028db-511">ヘッダーに対して次の改良が行われました。</span><span class="sxs-lookup"><span data-stu-id="028db-511">The following improvements were made to headers:</span></span><br><br><span data-ttu-id="028db-512">\* WCF Data Services は、指定されていない値を持つ `eTag` ヘッダーを正しく拒否するようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-512">\* WCF Data Services now correctly rejects an `eTag` header that has an unspecified value.</span></span><br><span data-ttu-id="028db-513">\* WCF Data Services は、要求に`if-*` ヘッダーがある場合にエラーを返すようになり、リンクへの削除要求に対する要求を実行しなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-513">\* WCF Data Services now returns an error and does not execute the request for a delete request to a link when an `if-*` header is in the request.</span></span><br><span data-ttu-id="028db-514">\* WCF Data Services は、クライアントが Accept ヘッダーに指定したフォーマット (Atom、JSON) でエラーをクライアントに返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-514">\* WCF Data Services now returns an error to the client in the format (Atom, JSON) that the client specified in the Accept header.</span></span> |
| <span data-ttu-id="028db-515">**JSON リーダー**</span><span class="sxs-lookup"><span data-stu-id="028db-515">**JSON Reader**</span></span> | <span data-ttu-id="028db-516">JavaScript Object Notation (JSON) リーダーは、WCF Data Service に送信された JSON ペイロードを処理する場合に、単一の円記号 ("\\") エスケープ文字を読み取ったときにエラーを正しく返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-516">The JavaScript Object Notation (JSON) reader now correctly returns an error when it reads the single backslash ("\\") escape character, when it processes JSON payloads sent to a WCF Data Service.</span></span> |
| <span data-ttu-id="028db-517">**マージ**</span><span class="sxs-lookup"><span data-stu-id="028db-517">**Merges**</span></span> | <span data-ttu-id="028db-518"><xref:System.Data.Services.Client.MergeOption> 列挙に対して次の改良が行われました。</span><span class="sxs-lookup"><span data-stu-id="028db-518">The following improvements were made to the <xref:System.Data.Services.Client.MergeOption> enumeration:</span></span><br><br><span data-ttu-id="028db-519">\* <xref:System.Data.Services.Client.MergeOption> マージ オプションは、データ サービスからの後続の応答の結果としてクライアントのエンティティを変更しなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-519">\* The <xref:System.Data.Services.Client.MergeOption> merge option no longer modifies the entity on the client as a result of any subsequent response from a data service.</span></span><br><span data-ttu-id="028db-520">\* <xref:System.Data.Services.Client.MergeOption> オプションは、動的 SQL とストアド プロシージャ ベースの更新との間で一貫性を持つようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-520">\* The <xref:System.Data.Services.Client.MergeOption> option is now consistent between dynamic SQL and stored procedure-based updates.</span></span> |
| <span data-ttu-id="028db-521">**要求**</span><span class="sxs-lookup"><span data-stu-id="028db-521">**Requests**</span></span> | <span data-ttu-id="028db-522">データ サービスへの要求が処理される前に、<xref:System.Data.Services.DataService%601.OnStartProcessingRequest%2A> メソッドが呼び出されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-522">The <xref:System.Data.Services.DataService%601.OnStartProcessingRequest%2A> method is now called before a request to data services is processed.</span></span> <span data-ttu-id="028db-523">これにより、<xref:System.Data.Services.Providers.ServiceOperation> サービスに対する要求が正しく動作するようになります。</span><span class="sxs-lookup"><span data-stu-id="028db-523">This enables the request to work correctly for <xref:System.Data.Services.Providers.ServiceOperation> services.</span></span> |
| <span data-ttu-id="028db-524">**ストリーム**</span><span class="sxs-lookup"><span data-stu-id="028db-524">**Streams**</span></span> | <span data-ttu-id="028db-525">WCF Data Services は、読み取り操作と書き込み操作の基になるストリームを閉じなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-525">WCF Data Services no longer closes the underlying stream for read and write operations.</span></span> |
| <span data-ttu-id="028db-526">**URI**</span><span class="sxs-lookup"><span data-stu-id="028db-526">**URIs**</span></span> | <span data-ttu-id="028db-527">WCF Data Services クライアントによる URI のエスケープが修正されました。</span><span class="sxs-lookup"><span data-stu-id="028db-527">The escaping of URIs by WCF Data Services client has been corrected.</span></span> |

## <a name="windows-communication-foundation-wcf"></a><span data-ttu-id="028db-528">Windows Communication Foundation (WCF)</span><span class="sxs-lookup"><span data-stu-id="028db-528">Windows Communication Foundation (WCF)</span></span>

<span data-ttu-id="028db-529">次の表に、以前は制限やその他の問題があった機能に対する改善点を示します。</span><span class="sxs-lookup"><span data-stu-id="028db-529">The following table describes improvements to features that previously had limitations or other issues.</span></span>

| <span data-ttu-id="028db-530">機能</span><span class="sxs-lookup"><span data-stu-id="028db-530">Feature</span></span> | <span data-ttu-id="028db-531">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-531">Differences from 3.5 SP1</span></span> |
| ------- | ------------------------ |
| <span data-ttu-id="028db-532">**構成ファイル**</span><span class="sxs-lookup"><span data-stu-id="028db-532">**Configuration files**</span></span> | <span data-ttu-id="028db-533">構成ファイル階層を通じた動作の継承を有効にするために、WCF は構成ファイル間でのマージをサポートするようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-533">To enable inheritance of behaviors through the configuration file hierarchy, WCF now supports merging across configuration files.</span></span><br><br><span data-ttu-id="028db-534">構成継承モデルは、コンピューターで実行されているすべてのサービスに適用される動作をユーザーが定義できるように拡張されました。</span><span class="sxs-lookup"><span data-stu-id="028db-534">The configuration inheritance model is now expanded to let users define behaviors that will be applied to all the services that are running on the computer.</span></span><br><br><span data-ttu-id="028db-535">異なる階層レベルに同じ名前の動作がある場合は、動作の変更が検出されることがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-535">You may encounter behavioral changes if there are behaviors with the same name at different levels of the hierarchy.</span></span> |
| <span data-ttu-id="028db-536">**サービス ホスティング**</span><span class="sxs-lookup"><span data-stu-id="028db-536">**Service hosting**</span></span> | <span data-ttu-id="028db-537">`allowDefinition="MachineToApplication"` 属性を要素定義に追加することにより、サービス レベルで `<serviceHostingEnvironment>` 構成要素を指定できなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-537">You can no longer specify the `<serviceHostingEnvironment>` configuration element at the service level by adding the attribute `allowDefinition="MachineToApplication"` to the element definition.</span></span><br><br><span data-ttu-id="028db-538">サービス レベルで `<serviceHostingEnvironment>` 要素を指定することは技術的に不適切であり、一貫性のない動作の原因になります。</span><span class="sxs-lookup"><span data-stu-id="028db-538">Specifying the `<serviceHostingEnvironment>` element at the service level is technically incorrect and causes inconsistent behavior.</span></span> |

## <a name="windows-presentation-foundation-wpf"></a><span data-ttu-id="028db-539">Windows Presentation Foundation (WPF)</span><span class="sxs-lookup"><span data-stu-id="028db-539">Windows Presentation Foundation (WPF)</span></span>

### <a name="applications"></a><span data-ttu-id="028db-540">アプリケーション</span><span class="sxs-lookup"><span data-stu-id="028db-540">Applications</span></span>

<span data-ttu-id="028db-541">名前空間: <xref:System.Windows>、<xref:System.Windows.Controls>。アセンブリ: PresentationFramework (PresentationFramework.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-541">Namespaces: <xref:System.Windows>, <xref:System.Windows.Controls>; assembly: PresentationFramework (in PresentationFramework.dll)</span></span>

| <span data-ttu-id="028db-542">機能</span><span class="sxs-lookup"><span data-stu-id="028db-542">Feature</span></span> | <span data-ttu-id="028db-543">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-543">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-544">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-544">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-545">**例外処理**</span><span class="sxs-lookup"><span data-stu-id="028db-545">**Exception handling**</span></span> | <span data-ttu-id="028db-546">エラーを早期に検出できるように、WPF では、元の例外をキャッチする代わりに、<xref:System.Reflection.TargetInvocationException> をスローし、<xref:System.Exception.InnerException> プロパティを重大な例外 (<xref:System.NullReferenceException>、<xref:System.OutOfMemoryException>、<xref:System.StackOverflowException>、<xref:System.Security.SecurityException> など) に設定します。</span><span class="sxs-lookup"><span data-stu-id="028db-546">To enable errors to be detected earlier, WPF throws a <xref:System.Reflection.TargetInvocationException> and sets the <xref:System.Exception.InnerException> property to critical exceptions, such as <xref:System.NullReferenceException>, <xref:System.OutOfMemoryException>, <xref:System.StackOverflowException>, and <xref:System.Security.SecurityException>, instead of catching the original exception.</span></span> | <span data-ttu-id="028db-547">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-547">None.</span></span> |
| <span data-ttu-id="028db-548">**リンク リソース**</span><span class="sxs-lookup"><span data-stu-id="028db-548">**Linked resources**</span></span> | <span data-ttu-id="028db-549">リンクを簡単にするために、プロジェクト フォルダー構造以外の場所にあるリソース ファイル (イメージなど) では、アプリケーションがビルドされるときに、ファイル名だけでなくリソース ファイルの完全パスをリソース ID として使用します。</span><span class="sxs-lookup"><span data-stu-id="028db-549">To make linking easier, resource files (such as images) that are located in a location other than the project's folder structure use the resource file's full path instead of just its file name as the resource ID when the application is built.</span></span> <span data-ttu-id="028db-550">これにより、アプリケーションが実行時にファイルを見つけられるようになります。</span><span class="sxs-lookup"><span data-stu-id="028db-550">The application will be able to locate the files at run time.</span></span> | <span data-ttu-id="028db-551">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-551">None.</span></span> |
| <span data-ttu-id="028db-552">**部分信頼アプリケーション**</span><span class="sxs-lookup"><span data-stu-id="028db-552">**Partial-trust applications**</span></span> | <span data-ttu-id="028db-553">セキュリティを考慮して、部分信頼で実行される Windows ベース アプリケーション、および <xref:System.Windows.Controls.WebBrowser> コントロールまたは HTML を格納する <xref:System.Windows.Controls.Frame> コントロールを含む Windows ベース アプリケーションは、コントロールが作成されるときに <xref:System.Security.SecurityException> をスローします。</span><span class="sxs-lookup"><span data-stu-id="028db-553">For security considerations, Windows-based applications that run in partial trust and contain a <xref:System.Windows.Controls.WebBrowser> control or a <xref:System.Windows.Controls.Frame> control that contains HTML will throw a <xref:System.Security.SecurityException> when the control is created.</span></span><br><br><span data-ttu-id="028db-554">次のすべての条件が満たされると、ブラウザー アプリケーションによって例外がスローされ、メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="028db-554">Browser applications will throw an exception and display a message if all of the following conditions are met:</span></span><br><br><span data-ttu-id="028db-555">\* アプリケーションを Firefox で実行している。</span><span class="sxs-lookup"><span data-stu-id="028db-555">\* The application is running in Firefox.</span></span><br><span data-ttu-id="028db-556">\* アプリケーションを、信頼されていないサイトのインターネット ゾーンで部分信頼によって実行している。</span><span class="sxs-lookup"><span data-stu-id="028db-556">\* The application is running in partial trust in the Internet zone from non-trusted sites.</span></span><br><span data-ttu-id="028db-557">\* アプリケーションに <xref:System.Windows.Controls.WebBrowser> コントロール、または HTML を格納する <xref:System.Windows.Controls.Frame> コントロールが含まれている。</span><span class="sxs-lookup"><span data-stu-id="028db-557">\* The application contains a <xref:System.Windows.Controls.WebBrowser> control or a <xref:System.Windows.Controls.Frame> control that contains HTML.</span></span><br><br><span data-ttu-id="028db-558">信頼されたサイトまたはイントラネット ゾーンから実行するアプリケーションは影響を受けません。</span><span class="sxs-lookup"><span data-stu-id="028db-558">Note that applications that run from trusted sites or from the intranet zone will not be affected.</span></span> | <span data-ttu-id="028db-559">ブラウザー アプリケーションで、次のいずれかを実行することでこの変更の影響を軽減できます。</span><span class="sxs-lookup"><span data-stu-id="028db-559">In your browser applications, you can ease this change by doing one of the following:</span></span><br><br><span data-ttu-id="028db-560">\* ブラウザー アプリケーションを完全信頼で実行します。</span><span class="sxs-lookup"><span data-stu-id="028db-560">\* Run the browser application in full trust.</span></span><br><span data-ttu-id="028db-561">\* 顧客に依頼して、アプリケーションのサイトを信頼されたサイト ゾーンに追加してもらいます。</span><span class="sxs-lookup"><span data-stu-id="028db-561">\* Have customers add the application's site to the trusted sites zone.</span></span><br><span data-ttu-id="028db-562">\* 顧客に依頼して、Internet Explorer を使用してアプリケーションを実行してもらいます。</span><span class="sxs-lookup"><span data-stu-id="028db-562">\* Have customers run the application in Internet Explorer.</span></span> |
| <span data-ttu-id="028db-563">**リソース ディクショナリ**</span><span class="sxs-lookup"><span data-stu-id="028db-563">**Resource dictionaries**</span></span> | <span data-ttu-id="028db-564">テーマ レベルのリソース ディクショナリを改善し、その変更を防ぐために、リソース ディクショナリで定義された固定可能リソース、およびテーマ レベル ディクショナリにマージされた固定可能リソースは、常に固定され、変更できなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-564">To improve theme-level resource dictionaries and prevent them from changing, freezable resources that are defined in a resource dictionary and merged into a theme-level dictionary are now always marked as frozen and are immutable.</span></span> <span data-ttu-id="028db-565">これは、固定可能リソースで想定される動作です。</span><span class="sxs-lookup"><span data-stu-id="028db-565">This is the expected behavior for freezable resources.</span></span> | <span data-ttu-id="028db-566">アプリケーションで、テーマ レベルでマージされたディクショナリで定義されたリソースを変更する場合は、リソースを複製して、複製した方のコピーを変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="028db-566">Applications that modify a resource that is defined in a theme-level merged dictionary should clone the resource and modify the cloned copy.</span></span> <span data-ttu-id="028db-567">または、リソースを `x:Shared="false"` とマークして、リソースにクエリが実行されるたびに <xref:System.Windows.ResourceDictionary> が新しいコピーを作成できるようにします。</span><span class="sxs-lookup"><span data-stu-id="028db-567">Alternatively, the resource can be marked `x:Shared="false"` so that the <xref:System.Windows.ResourceDictionary> creates a new copy every time the resource is queried.</span></span> |
| <span data-ttu-id="028db-568">**Windows 7**</span><span class="sxs-lookup"><span data-stu-id="028db-568">**Windows 7**</span></span> | <span data-ttu-id="028db-569">WPF アプリケーションを Windows 7 でより適切に動作させるために、ウィンドウの動作を修正する次の改良が行われました。</span><span class="sxs-lookup"><span data-stu-id="028db-569">To make WPF applications work better on Windows 7, the following improvements were made to correct the behavior of a window:</span></span><br><br><span data-ttu-id="028db-570">\* ドッキングとジェスチャの状態は、ユーザーとのやり取りに基づいて予想どおりに動作するようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-570">\* Dock and gesture states now work as expected based on user interactions.</span></span><br><span data-ttu-id="028db-571">\* タスク バー コマンドの **[重ねて表示]、[ウィンドウを上下に並べて表示]**、**[ウィンドウを左右に並べて表示]** は正しく動作し、適切なプロパティを更新するようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-571">\* The taskbar commands **Cascade windows, Show windows stacked**, and **Show windows side-by-side** now have the correct behavior and update the appropriate properties.</span></span><br><span data-ttu-id="028db-572">\* 最大化または最小化されたウィンドウの `Top`、`Left`、`Width`、`Height` の各プロパティには、モニターに応じて、他の値ではなくウィンドウの適切な復元場所が含まれるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-572">\* The `Top`, `Left`, `Width`, and `Height` properties for a maximized or minimized window now contain the correct restore location of the window instead of other values, depending on the monitor.</span></span> | <span data-ttu-id="028db-573">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-573">None.</span></span> |
| <span data-ttu-id="028db-574">**ウィンドウのスタイルと透過性**</span><span class="sxs-lookup"><span data-stu-id="028db-574">**Windows style and transparency**</span></span> | <span data-ttu-id="028db-575"><xref:System.Windows.Window.AllowsTransparency> が `true` で、<xref:System.Windows.WindowState> が <xref:System.Windows.WindowState> のときに、<xref:System.Windows.Window.WindowStyle> を <xref:System.Windows.WindowStyle> 以外の値に設定しようとすると、<xref:System.InvalidOperationException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="028db-575">An <xref:System.InvalidOperationException> is thrown if you try to set <xref:System.Windows.Window.WindowStyle> to a value other than <xref:System.Windows.WindowStyle> when <xref:System.Windows.Window.AllowsTransparency> is `true` and <xref:System.Windows.WindowState> is <xref:System.Windows.WindowState>.</span></span> | <span data-ttu-id="028db-576"><xref:System.Windows.Window.AllowsTransparency> が `true` であるときに、<xref:System.Windows.Window.WindowStyle> を変更する必要がある場合は、Win32 の `SetWindowLongPtr` 関数を呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="028db-576">If you must change the <xref:System.Windows.Window.WindowStyle> when <xref:System.Windows.Window.AllowsTransparency> is `true`, you can call the Win32 `SetWindowLongPtr` function.</span></span> |
| <span data-ttu-id="028db-577">**XPS ビューアー**</span><span class="sxs-lookup"><span data-stu-id="028db-577">**XPS Viewer**</span></span> | <span data-ttu-id="028db-578">WPF には Microsoft XML Paper Specification Essentials Pack (XPSEP) が含まれていません。</span><span class="sxs-lookup"><span data-stu-id="028db-578">WPF does not include the Microsoft XML Paper Specification Essentials Pack (XPSEP).</span></span> <span data-ttu-id="028db-579">XPSEP は Windows 7 と Windows Vista に付属しています。</span><span class="sxs-lookup"><span data-stu-id="028db-579">XPSEP is included with Windows 7 and Windows Vista.</span></span><br><br><span data-ttu-id="028db-580">.NET Framework 3.5 SP1 がインストールされていない Windows XP を実行中のコンピューターでは、<xref:System.Windows.Controls.PrintDialog> 以外の WPF API を使用した印刷は WINSPOOL に依存します。</span><span class="sxs-lookup"><span data-stu-id="028db-580">On a computer that is running Windows XP without the .NET Framework 3.5 SP1 installed, printing by using a WPF API other than those in <xref:System.Windows.Controls.PrintDialog> will rely on the WINSPOOL.</span></span> <span data-ttu-id="028db-581">その場合、印刷の実行中に一部のプリンター機能が表示されないことや、プリンター設定が適用されないことが考えられます。</span><span class="sxs-lookup"><span data-stu-id="028db-581">Some printer capabilities will not be reported and some printer settings will not be applied during printing.</span></span> | <span data-ttu-id="028db-582">必要に応じて [Microsoft XML Paper Specification Essentials Pack](https://go.microsoft.com/fwlink/?LinkId=178895) をインストールしてください。</span><span class="sxs-lookup"><span data-stu-id="028db-582">If needed, install the [Microsoft XML Paper Specification Essentials Pack](https://go.microsoft.com/fwlink/?LinkId=178895).</span></span> |

### <a name="controls"></a><span data-ttu-id="028db-583">コントロール</span><span class="sxs-lookup"><span data-stu-id="028db-583">Controls</span></span>

<span data-ttu-id="028db-584">名前空間: <xref:System.Windows>、<xref:System.Windows.Controls>、<xref:System.Windows.Data>、<xref:System.Windows.Input>。アセンブリ: PresentationFramework (PresentationFramework.dll 内)、PresentationCore (PresentationCore.dll 内)、WindowsBase (WindowsBase.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-584">Namespaces: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>; assemblies: PresentationFramework (in PresentationFramework.dll), PresentationCore (in PresentationCore.dll), WindowsBase (in WindowsBase.dll)</span></span>

| <span data-ttu-id="028db-585">機能</span><span class="sxs-lookup"><span data-stu-id="028db-585">Feature</span></span> | <span data-ttu-id="028db-586">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-586">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-587">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-587">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-588">**ダイアログ ボックス**</span><span class="sxs-lookup"><span data-stu-id="028db-588">**Dialog boxes**</span></span> | <span data-ttu-id="028db-589">信頼性を高めるために、<xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> メソッドは、<xref:Microsoft.Win32.FileDialog> コントロールを作成したのと同じスレッド上で呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="028db-589">To improve reliability, the <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> method is called on the same thread that created the <xref:Microsoft.Win32.FileDialog> control.</span></span> | <span data-ttu-id="028db-590">必ず <xref:Microsoft.Win32.FileDialog> コントロールを作成して、同じスレッド上で <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> メソッドを呼び出すようにしてください。</span><span class="sxs-lookup"><span data-stu-id="028db-590">Be sure to create a <xref:Microsoft.Win32.FileDialog> control and call the <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> method on the same thread.</span></span> |
| <span data-ttu-id="028db-591">**フローティング ウィンドウ**</span><span class="sxs-lookup"><span data-stu-id="028db-591">**Floating windows**</span></span> | <span data-ttu-id="028db-592">フローティング ウィンドウの再アクティブ化が間違って保持される (モーダル ダイアログ ボックスのように表示される) フォーカス復元ロジックを修正するために、候補がウィンドウの子でない場合にはフォーカスが復元されないようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-592">To fix focus restoration logic that incorrectly keeps reactivating a floating window (making it appear like a modal dialog box), focus restoration is now prevented if the candidate is not a child of the window.</span></span> | <span data-ttu-id="028db-593">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-593">None.</span></span> |
| <span data-ttu-id="028db-594">**コレクションの項目**</span><span class="sxs-lookup"><span data-stu-id="028db-594">**Items in collections**</span></span> | <span data-ttu-id="028db-595">基になるコレクションに項目が移動または追加されたときは、<xref:System.Windows.Data.CollectionView> を並べ替えない限り、その項目は <xref:System.Windows.Data.CollectionView> でも同じ場所に表示されます。</span><span class="sxs-lookup"><span data-stu-id="028db-595">When an item is moved or added to an underlying collection, it appears in the <xref:System.Windows.Data.CollectionView> in the same relative location if the <xref:System.Windows.Data.CollectionView> is not sorted.</span></span> <span data-ttu-id="028db-596">この処理により、コレクション内の項目の場所と、関連付けられた <xref:System.Windows.Data.CollectionView> 内の項目の場所との間で一貫性が保たれます。</span><span class="sxs-lookup"><span data-stu-id="028db-596">This provides consistency between the item's position in the collection and in the associated <xref:System.Windows.Data.CollectionView>.</span></span> | <span data-ttu-id="028db-597">固定された場所にある項目に依存する代わりに、<xref:System.Windows.Controls.ItemContainerGenerator.ContainerFromItem%2A> メソッドまたは <xref:System.Windows.Data.CollectionView.IndexOf%2A> メソッドを使用して、<xref:System.Windows.Data.CollectionView> 内で項目の場所を検索します。</span><span class="sxs-lookup"><span data-stu-id="028db-597">Use the <xref:System.Windows.Controls.ItemContainerGenerator.ContainerFromItem%2A> or <xref:System.Windows.Data.CollectionView.IndexOf%2A> method to find the location of an item in a <xref:System.Windows.Data.CollectionView> instead of relying on a fixed location of an item.</span></span> |
| <span data-ttu-id="028db-598">**レイアウト**</span><span class="sxs-lookup"><span data-stu-id="028db-598">**Layouts**</span></span> | <span data-ttu-id="028db-599">不要な再レイアウトを排除するために、<xref:System.Windows.Controls.Page.ShowsNavigationUI> を変更しても、レイアウトが無効にされたり、別のレイアウト パスが実行されたりすることがなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-599">To eliminate unnecessary re-layouts, changing the <xref:System.Windows.Controls.Page.ShowsNavigationUI> no longer invalidates layout or causes another layout pass.</span></span> | <span data-ttu-id="028db-600"><xref:System.Windows.Controls.Page.ShowsNavigationUI> を変更して別のレイアウト パスを実行する場合は、プロパティの設定後に <xref:System.Windows.UIElement.InvalidateVisual%2A> を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="028db-600">If you expect that changing <xref:System.Windows.Controls.Page.ShowsNavigationUI> will cause another layout pass, call <xref:System.Windows.UIElement.InvalidateVisual%2A> after you set the property.</span></span> |
| <span data-ttu-id="028db-601">**メニュー**</span><span class="sxs-lookup"><span data-stu-id="028db-601">**Menus**</span></span> | <span data-ttu-id="028db-602">メニュー ポップアップで ClearType テキストを有効にするために、<xref:System.Windows.Controls.ControlTemplate> クラスと、<xref:System.Windows.Controls.MenuItem> などのコントロールが変更されました。</span><span class="sxs-lookup"><span data-stu-id="028db-602">To enable ClearType text in menu pop-ups, modifications were made to the <xref:System.Windows.Controls.ControlTemplate> class and to the <xref:System.Windows.Controls.MenuItem> control and other controls.</span></span> | <span data-ttu-id="028db-603">アプリケーションを、コントロール テンプレートの視覚的な構造に依存させないでください。</span><span class="sxs-lookup"><span data-stu-id="028db-603">Applications should not rely on the visual structure of control templates.</span></span> <span data-ttu-id="028db-604">パブリック コントラクトの一部であるのは <xref:System.Windows.Controls.ControlTemplate> の名前付きパーツのみです。</span><span class="sxs-lookup"><span data-stu-id="028db-604">Only named parts of a <xref:System.Windows.Controls.ControlTemplate> are part of the public contract.</span></span> <span data-ttu-id="028db-605">アプリケーションで <xref:System.Windows.Controls.ControlTemplate> 内の任意のオブジェクトを検索する必要がある場合は、ツリー内で固定されたオブジェクトの場所に依存するのではなく、ビジュアル ツリーで特定の型を検索するようにします。</span><span class="sxs-lookup"><span data-stu-id="028db-605">If an application must find a certain object in a <xref:System.Windows.Controls.ControlTemplate>, search the visual tree for a specific type instead of relying on a fixed location of an object in the tree.</span></span> |
| <span data-ttu-id="028db-606">**ナビゲーション**</span><span class="sxs-lookup"><span data-stu-id="028db-606">**Navigating**</span></span> | <span data-ttu-id="028db-607"><xref:System.Windows.Controls.Frame> で、ある場所に直接移動する場合、<xref:System.Windows.Navigation.NavigatingCancelEventArgs.IsNavigationInitiator> プロパティは最初の移動後に `true` になります。</span><span class="sxs-lookup"><span data-stu-id="028db-607">If a <xref:System.Windows.Controls.Frame> directly navigates to a location, the <xref:System.Windows.Navigation.NavigatingCancelEventArgs.IsNavigationInitiator> property is `true` after the initial navigation.</span></span> <span data-ttu-id="028db-608">この変更により、起動シナリオ中に他のイベントが発生しなくなります。</span><span class="sxs-lookup"><span data-stu-id="028db-608">This change prevents additional events from being raised during startup scenarios.</span></span> | <span data-ttu-id="028db-609">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-609">None.</span></span> |
| <span data-ttu-id="028db-610">**ポップアップ**</span><span class="sxs-lookup"><span data-stu-id="028db-610">**Pop-ups**</span></span> | <span data-ttu-id="028db-611"><xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> デリゲートは、レイアウト パスの実行中に複数回 (従来は 1 回のみ) 呼び出すことができるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-611">The <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> delegate can now be called multiple times during a layout pass instead of only once.</span></span> | <span data-ttu-id="028db-612"><xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> デリゲートで <xref:System.Windows.Controls.Primitives.Popup> の場所を以前の場所に基づいて計算する場合は、`popupSize`、`targetSize`、`offset` のいずれかのパラメーターの値が変更された場合にのみ場所を再計算します。</span><span class="sxs-lookup"><span data-stu-id="028db-612">If your <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> delegate calculates the position of a <xref:System.Windows.Controls.Primitives.Popup> based on its previous position, recalculate the position only if the values of the `popupSize`, `targetSize`, or `offset` parameters change.</span></span> |
| <span data-ttu-id="028db-613">**プロパティの値**</span><span class="sxs-lookup"><span data-stu-id="028db-613">**Property values**</span></span> | <span data-ttu-id="028db-614"><xref:System.Windows.DependencyObject.SetCurrentValue%2A> メソッドでは、バインディング、スタイル、またはトリガーによるプロパティへの影響を維持したまま、プロパティに有効な値を設定できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-614">The <xref:System.Windows.DependencyObject.SetCurrentValue%2A> method now lets you set a property to an effective value, although it continues to respects any binding, style, or trigger that affects the property.</span></span> | <span data-ttu-id="028db-615">コントロールの作成で、ユーザー操作などの他のアクションに影響を与えるプロパティ値の変更が伴う場合は、常に <xref:System.Windows.DependencyObject.SetCurrentValue%2A> を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="028db-615">Control authors should use <xref:System.Windows.DependencyObject.SetCurrentValue%2A> whenever the property value changes as a side-effect of some other action, including user manipulation.</span></span> |
| <span data-ttu-id="028db-616">**テキスト ボックス**</span><span class="sxs-lookup"><span data-stu-id="028db-616">**Text boxes**</span></span> | <span data-ttu-id="028db-617">セキュリティを考慮して、<xref:System.Windows.Forms.TextBoxBase.Copy%2A> メソッドと <xref:System.Windows.Forms.TextBoxBase.Cut%2A> メソッドは、部分信頼で呼び出されるとエラーなしで失敗します。</span><span class="sxs-lookup"><span data-stu-id="028db-617">For security considerations, the <xref:System.Windows.Forms.TextBoxBase.Copy%2A> and <xref:System.Windows.Forms.TextBoxBase.Cut%2A> methods silently fail when they are called in partial trust.</span></span><br><br><span data-ttu-id="028db-618">また、<xref:System.Windows.Controls.Primitives.TextBoxBase> から継承するコントロールで、<xref:System.Windows.Input.ApplicationCommands.Copy> プロパティまたは <xref:System.Windows.Input.ApplicationCommands.Cut> プロパティをプログラムによって実行すると、部分信頼が原因でブロックされます。</span><span class="sxs-lookup"><span data-stu-id="028db-618">In addition, programmatic execution of the <xref:System.Windows.Input.ApplicationCommands.Copy> or <xref:System.Windows.Input.ApplicationCommands.Cut> property on a control that inherits from <xref:System.Windows.Controls.Primitives.TextBoxBase> will be blocked in partial trust.</span></span> <span data-ttu-id="028db-619">ただし、ユーザーが起動したコピーおよび切り取りのコマンド (<xref:System.Windows.Controls.Primitives.ButtonBase.Command> プロパティがこれらのコマンドの 1 つにバインドされているボタンをクリックする場合など) は動作します。</span><span class="sxs-lookup"><span data-stu-id="028db-619">However, user-initiated copy and cut commands, such as clicking a button whose <xref:System.Windows.Controls.Primitives.ButtonBase.Command> property is bound to one of these commands, will work.</span></span> <span data-ttu-id="028db-620">キーボード ショートカットおよびコンテキスト メニューを使用した標準的なコピーと切り取りも、以前と同様に部分信頼で機能します。</span><span class="sxs-lookup"><span data-stu-id="028db-620">Standard copy and cut through keyboard shortcuts and the context menu will still work as before in partial trust.</span></span> | <span data-ttu-id="028db-621"><xref:System.Windows.Input.ApplicationCommands.Copy> コマンドまたは <xref:System.Windows.Input.ApplicationCommands.Cut> コマンドを、ボタンのクリックのようなユーザーが開始するアクションにバインドします。</span><span class="sxs-lookup"><span data-stu-id="028db-621">Bind the <xref:System.Windows.Input.ApplicationCommands.Copy> or <xref:System.Windows.Input.ApplicationCommands.Cut> command to a user-initiated action, such as clicking a button.</span></span> |

### <a name="graphics"></a><span data-ttu-id="028db-622">グラフィックス</span><span class="sxs-lookup"><span data-stu-id="028db-622">Graphics</span></span>

<span data-ttu-id="028db-623">名前空間: <xref:System.Windows>、<xref:System.Windows.Controls>、<xref:System.Windows.Data>、<xref:System.Windows.Input>、<xref:System.Windows.Media.Effects>。アセンブリ: PresentationFramework (PresentationFramework.dll 内)、PresentationCore (PresentationCore.dll 内)、WindowsBase (WindowsBase.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-623">Namespaces: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>, <xref:System.Windows.Media.Effects>; assemblies: PresentationFramework (in PresentationFramework.dll), PresentationCore (in PresentationCore.dll), WindowsBase (in WindowsBase.dll)</span></span>

| <span data-ttu-id="028db-624">機能</span><span class="sxs-lookup"><span data-stu-id="028db-624">Feature</span></span> | <span data-ttu-id="028db-625">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-625">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-626">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-626">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-627">**ビットマップ効果**</span><span class="sxs-lookup"><span data-stu-id="028db-627">**Bitmap effects**</span></span> | <span data-ttu-id="028db-628">パフォーマンスを向上させるために、<xref:System.Windows.Media.Effects.BitmapEffect> クラスと、<xref:System.Windows.Media.Effects.BitmapEffect> クラスから継承するクラスは、引き続き存在していますが、無効になっています。</span><span class="sxs-lookup"><span data-stu-id="028db-628">To improve performance, the <xref:System.Windows.Media.Effects.BitmapEffect> class and the classes that inherit from the <xref:System.Windows.Media.Effects.BitmapEffect> class, although still present, are disabled.</span></span> <span data-ttu-id="028db-629">効果は、次の条件を満たす場合に、ハードウェア アクセラレータによるレンダリング パイプラインを使用して表示されます。</span><span class="sxs-lookup"><span data-stu-id="028db-629">The effect will render by using the hardware-accelerated rendering pipeline if the following conditions are true:</span></span><br><br><span data-ttu-id="028db-630">\* アプリケーションで、100 DIU 未満の半径のプロパティ セットを持つ <xref:System.Windows.Media.Effects.DropShadowBitmapEffect> または <xref:System.Windows.Media.Effects.BlurBitmapEffect> を使用する。</span><span class="sxs-lookup"><span data-stu-id="028db-630">\* The application uses a <xref:System.Windows.Media.Effects.DropShadowBitmapEffect> or a <xref:System.Windows.Media.Effects.BlurBitmapEffect> that has a radius property set less than 100 DIU.</span></span><br><span data-ttu-id="028db-631">\* アプリケーションを実行するコンピューター上のビデオ カードがピクセル シェーダー 2.0 をサポートしている。</span><span class="sxs-lookup"><span data-stu-id="028db-631">\* The video card on the computer that runs the application supports pixel shader 2.0.</span></span><br><br><span data-ttu-id="028db-632">これらの条件が満たされない場合、<xref:System.Windows.Media.Effects.BitmapEffect> オブジェクトは無効になります。</span><span class="sxs-lookup"><span data-stu-id="028db-632">If these conditions are not met, a <xref:System.Windows.Media.Effects.BitmapEffect> object will have no effect.</span></span><br><br><span data-ttu-id="028db-633">また、Visual Studio では、<xref:System.Windows.Media.Effects.BitmapEffect> オブジェクトまたはサブクラスが見つかった場合にコンパイラの警告が生成されます。</span><span class="sxs-lookup"><span data-stu-id="028db-633">Also, Visual Studio produces a compiler warning when it encounters the <xref:System.Windows.Media.Effects.BitmapEffect> object or a subclass.</span></span><br><br><span data-ttu-id="028db-634"><xref:System.Windows.Media.DrawingContext.PushEffect%2A> メソッドは現在は使用されていません。</span><span class="sxs-lookup"><span data-stu-id="028db-634">The <xref:System.Windows.Media.DrawingContext.PushEffect%2A> method is marked obsolete.</span></span> | <span data-ttu-id="028db-635">従来の <xref:System.Windows.Media.Effects.BitmapEffect> と派生クラスの使用を中止し、<xref:System.Windows.Media.Effects.Effect>、<xref:System.Windows.Media.Effects.BlurEffect>、<xref:System.Windows.Media.Effects.DropShadowEffect><xref:System.Windows.Media.Effects.ShaderEffect> から派生した新しいクラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="028db-635">Discontinue using the legacy <xref:System.Windows.Media.Effects.BitmapEffect> and derived classes and instead use the new classes derived from <xref:System.Windows.Media.Effects.Effect>: <xref:System.Windows.Media.Effects.BlurEffect>, <xref:System.Windows.Media.Effects.DropShadowEffect>, and <xref:System.Windows.Media.Effects.ShaderEffect>.</span></span><br><br><span data-ttu-id="028db-636"><xref:System.Windows.Media.Effects.ShaderEffect> クラスから継承することで、独自の効果を作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="028db-636">You can also create your own effects by inheriting from the <xref:System.Windows.Media.Effects.ShaderEffect> class.</span></span> |
| <span data-ttu-id="028db-637">**ビットマップ フレーム**</span><span class="sxs-lookup"><span data-stu-id="028db-637">**Bitmap frames**</span></span> | <span data-ttu-id="028db-638">複製された <xref:System.Windows.Media.Imaging.BitmapFrame> オブジェクトは <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress> イベント、<xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted> イベント、<xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> イベントを受け取るようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-638">The cloned <xref:System.Windows.Media.Imaging.BitmapFrame> objects now receive the <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress>, <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted>, and <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> events.</span></span> <span data-ttu-id="028db-639">この処理により、Web からダウンロードされ、<xref:System.Windows.Controls.Image> コントロールに適用されたイメージが <xref:System.Windows.Style> で適切に動作するようになります。</span><span class="sxs-lookup"><span data-stu-id="028db-639">This enables images that are downloaded from the Web and applied to the <xref:System.Windows.Controls.Image> control through a <xref:System.Windows.Style> to work correctly.</span></span><br><br><span data-ttu-id="028db-640">次の状況のすべてに当てはまる場合にのみ、動作が変化します。</span><span class="sxs-lookup"><span data-stu-id="028db-640">You will see a change in behavior only if all of the following statements are true:</span></span><br><br><span data-ttu-id="028db-641">\* <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress> イベント、<xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted> イベント、または <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> イベントをサブスクライブします。</span><span class="sxs-lookup"><span data-stu-id="028db-641">\* You subscribe to the <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress>, <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted>, or <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> event.</span></span><br><span data-ttu-id="028db-642">\* <xref:System.Windows.Media.Imaging.BitmapFrame> のソースを Web から取得します。</span><span class="sxs-lookup"><span data-stu-id="028db-642">\* The source of the <xref:System.Windows.Media.Imaging.BitmapFrame> is from the Web.</span></span><br><span data-ttu-id="028db-643">\* ダウンロードの実行中に、<xref:System.Windows.Media.Imaging.BitmapFrame> が複製されます。</span><span class="sxs-lookup"><span data-stu-id="028db-643">\* The <xref:System.Windows.Media.Imaging.BitmapFrame> is cloned while the download is still in progress.</span></span> | <span data-ttu-id="028db-644">イベント ハンドラーで送信元をチェックして、送信元が元の <xref:System.Windows.Media.Imaging.BitmapFrame> である場合にのみ対応策を取ります。</span><span class="sxs-lookup"><span data-stu-id="028db-644">Check the sender in the event handler and take action only if the sender is the original <xref:System.Windows.Media.Imaging.BitmapFrame>.</span></span> |
| <span data-ttu-id="028db-645">**イメージのデコード**</span><span class="sxs-lookup"><span data-stu-id="028db-645">**Decoding images**</span></span> | <span data-ttu-id="028db-646">イメージをデコードできない可能性がある場合に <xref:System.IO.IOException> が処理されるのを防ぐため、<xref:System.Windows.Media.Imaging.BitmapSource> クラスは、イメージをデコードできない場合に <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="028db-646">To prevent an <xref:System.IO.IOException> from not being handled when images may not decode, the <xref:System.Windows.Media.Imaging.BitmapSource> class will raise the <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> event when it does not decode an image.</span></span> | <span data-ttu-id="028db-647"><xref:System.IO.IOException> の例外処理を削除し、<xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> イベントを使用してデコードの失敗を確認します。</span><span class="sxs-lookup"><span data-stu-id="028db-647">Remove any exception handling for <xref:System.IO.IOException>, and use the <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> event to check for decode failure.</span></span> |

### <a name="input"></a><span data-ttu-id="028db-648">入力</span><span class="sxs-lookup"><span data-stu-id="028db-648">Input</span></span>

<span data-ttu-id="028db-649">名前空間: <xref:System.Windows>、<xref:System.Windows.Controls>、<xref:System.Windows.Data>、<xref:System.Windows.Input>。アセンブリ: PresentationFramework (PresentationFramework.dll 内)、PresentationCore (PresentationCore.dll 内)、WindowsBase (WindowsBase.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-649">Namespaces: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>; assemblies: PresentationFramework (in PresentationFramework.dll), PresentationCore (in PresentationCore.dll), WindowsBase (in WindowsBase.dll)</span></span>

| <span data-ttu-id="028db-650">機能</span><span class="sxs-lookup"><span data-stu-id="028db-650">Feature</span></span> | <span data-ttu-id="028db-651">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-651">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-652">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-652">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-653">**コマンド インスタンスのバインディング**</span><span class="sxs-lookup"><span data-stu-id="028db-653">**Binding command instances**</span></span> | <span data-ttu-id="028db-654">ビュー モデル ベースのコマンド インスタンスをビュー ベースの入力ジェスチャにバインドするメカニズムを提供するために、<xref:System.Windows.Input.InputBinding> クラスは、<xref:System.Windows.DependencyObject> ではなく <xref:System.Windows.Freezable> から継承するようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-654">To provide a mechanism to bind View-Model-based command instances to View-based input gestures, the <xref:System.Windows.Input.InputBinding> class now inherits from <xref:System.Windows.Freezable> instead of <xref:System.Windows.DependencyObject>.</span></span> <span data-ttu-id="028db-655">次のプロパティは依存関係プロパティになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-655">The following properties are now dependency properties:</span></span><br><br>* <xref:System.Windows.Input.InputBinding.Command><br>* <xref:System.Windows.Input.InputBinding.CommandParameter><br>* <xref:System.Windows.Input.InputBinding.CommandTarget><br><br><span data-ttu-id="028db-656">この変更の結果は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="028db-656">This change results in the following:</span></span><br><br><span data-ttu-id="028db-657">\* <xref:System.Windows.Input.InputBinding> オブジェクトは、登録時に固定され、変更できない状態になります。</span><span class="sxs-lookup"><span data-stu-id="028db-657">\* An <xref:System.Windows.Input.InputBinding> object is now frozen when it is registered instead of remaining mutable.</span></span><br><span data-ttu-id="028db-658">\* <xref:System.Windows.DependencyObject> クラスの制限により、複数のスレッドからインスタンス レベルの <xref:System.Windows.Input.InputBinding> オブジェクトにアクセスすることはできません。</span><span class="sxs-lookup"><span data-stu-id="028db-658">\* You cannot access instance-level <xref:System.Windows.Input.InputBinding> objects from multiple threads, due to the restrictions of the <xref:System.Windows.DependencyObject> class.</span></span><br><span data-ttu-id="028db-659">\* <xref:System.Windows.Freezable> クラスの制限により、登録後にクラス レベルの入力バインディングを変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="028db-659">\* You cannot mutate class-level input bindings after their registration, due to the restrictions of the <xref:System.Windows.Freezable> class.</span></span><br><span data-ttu-id="028db-660">\* ビュー モデルで作成されたコマンド インスタンスに入力バインディングを指定することはできません。</span><span class="sxs-lookup"><span data-stu-id="028db-660">\* You cannot specify input bindings on command instances that are created in a View-Model.</span></span> | <span data-ttu-id="028db-661">バインディングを変更可能にする場合は、スレッドごとに <xref:System.Windows.Input.InputBinding> クラスのインスタンスを個別に作成します。それ以外の場合は、バインディングを固定します。</span><span class="sxs-lookup"><span data-stu-id="028db-661">Create separate instances of an <xref:System.Windows.Input.InputBinding> class on separate threads if bindings are to be mutable, or freeze them otherwise.</span></span> <span data-ttu-id="028db-662">クラス レベルの静的 <xref:System.Windows.Input.InputBinding> は、登録後に変更しないでください。</span><span class="sxs-lookup"><span data-stu-id="028db-662">Do not mutate a class-level static <xref:System.Windows.Input.InputBinding> after it has been registered.</span></span> |
| <span data-ttu-id="028db-663">**ブラウザー アプリケーション**</span><span class="sxs-lookup"><span data-stu-id="028db-663">**Browser applications**</span></span> | <span data-ttu-id="028db-664">WPF ブラウザー アプリケーション (.XBAP) では、スタンドアロン WPF アプリケーションと同じようにキー イベントを処理することで、オブジェクトが正しい順序でルーティング キー イベントを受け取れるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-664">WPF Browser applications (.XBAP) now process key events just like stand-alone WPF applications so that objects receive routed key events in the correct order.</span></span> | <span data-ttu-id="028db-665">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-665">None.</span></span> |
| <span data-ttu-id="028db-666">**デッド キーの組み合わせ**</span><span class="sxs-lookup"><span data-stu-id="028db-666">**Dead key combinations**</span></span> | <span data-ttu-id="028db-667">WPF ではデッド キーが難読化されています。デッド キーとは、そのキーを押しても文字は表示されないものの、続けて文字キーを押してその文字と組み合わせることで、1 つの文字が生成されるキーのことです。</span><span class="sxs-lookup"><span data-stu-id="028db-667">WPF obfuscates dead keys, which produce no visible character, but instead indicates that the key is to be combined with the next letter key to produce one character.</span></span> <span data-ttu-id="028db-668"><xref:System.Windows.Input.Keyboard.KeyDownEvent> イベントなどのキー入力イベントでは、<xref:System.Windows.Input.KeyEventArgs.Key> プロパティを <xref:System.Windows.Input.Key> 値に設定することで、入力されたキーがデッド キーであることを通知します。</span><span class="sxs-lookup"><span data-stu-id="028db-668">The key input events, such as the <xref:System.Windows.Input.Keyboard.KeyDownEvent> event, report when a key is a dead key by setting the <xref:System.Windows.Input.KeyEventArgs.Key> property to the <xref:System.Windows.Input.Key> value.</span></span> <span data-ttu-id="028db-669">これは通常予期される動作です。アプリケーションは一般に、1 つの文字を組み合わせて作成する場合のキーボード入力に応答しないためです。</span><span class="sxs-lookup"><span data-stu-id="028db-669">This is usually expected behavior because applications usually do not intend to respond to keyboard input that creates a combined character.</span></span> | <span data-ttu-id="028db-670">組み合わせ文字の一部になり得るキーの読み取りが予測されるアプリケーションでは、<xref:System.Windows.Input.KeyEventArgs.DeadCharProcessedKey> プロパティを使用して、難読化されたキーを取得できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-670">Applications that expect to read keys that were part of combined characters can get the now obfuscated key by using the <xref:System.Windows.Input.KeyEventArgs.DeadCharProcessedKey> property.</span></span> |
| <span data-ttu-id="028db-671">**フォーカス マネージャー**</span><span class="sxs-lookup"><span data-stu-id="028db-671">**Focus manager**</span></span> | <span data-ttu-id="028db-672">[IsFocusScope](xref:System.Windows.Input.FocusManager.IsFocusScope%2A) 添付プロパティが `true` に設定されている要素が <xref:System.Windows.Input.FocusManager.GetFocusedElement(System.Windows.DependencyObject)?displayProperty=nameWithType> メソッドに渡されると、このメソッドは、そのフォーカス スコープ内で最後にキーボード フォーカスされた要素を返します。ただしこれは、返される要素が、メソッドに渡された要素と同じ <xref:System.Windows.PresentationSource> オブジェクトに属する場合に限られます。</span><span class="sxs-lookup"><span data-stu-id="028db-672">When the <xref:System.Windows.Input.FocusManager.GetFocusedElement(System.Windows.DependencyObject)?displayProperty=nameWithType> method is passed an element that has the [IsFocusScope](xref:System.Windows.Input.FocusManager.IsFocusScope%2A) attached property set to `true`, the method returns an element that is the last keyboard-focused element within that focus scope if and only if the returned element belongs to the same <xref:System.Windows.PresentationSource> object as the element that is passed to the method.</span></span> | <span data-ttu-id="028db-673">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-673">None.</span></span> |

### <a name="ui-automation"></a><span data-ttu-id="028db-674">UI オートメーション</span><span class="sxs-lookup"><span data-stu-id="028db-674">UI Automation</span></span>

<span data-ttu-id="028db-675">Namespace: <xref:System.Windows>、<xref:System.Windows.Automation.Peers>、<xref:System.Windows.Automation.Provider>、<xref:System.Windows.Controls>、<xref:System.Windows.Data>、<xref:System.Windows.Input>。アセンブリ: PresentationFramework (PresentationFramework.dll 内)、PresentationCore (PresentationCore.dll 内)、UIAutomationProvider (UIAutomationProvider.dll 内)、WindowsBase (WindowsBase.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-675">Namespace: <xref:System.Windows>, <xref:System.Windows.Automation.Peers>, <xref:System.Windows.Automation.Provider>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>; assemblies: PresentationFramework (in PresentationFramework.dll), PresentationCore (in PresentationCore.dll), UIAutomationProvider (in UIAutomationProvider.dll), WindowsBase (in WindowsBase.dll)</span></span>

| <span data-ttu-id="028db-676">機能</span><span class="sxs-lookup"><span data-stu-id="028db-676">Feature</span></span> | <span data-ttu-id="028db-677">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-677">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-678">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-678">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-679">**ビューのクラス階層**</span><span class="sxs-lookup"><span data-stu-id="028db-679">**Class hierarchy of views**</span></span> | <span data-ttu-id="028db-680"><xref:System.Windows.Automation.Peers.TreeViewAutomationPeer> クラスと <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> クラスは、<xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer> ではなく <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer> から継承されます。</span><span class="sxs-lookup"><span data-stu-id="028db-680">The <xref:System.Windows.Automation.Peers.TreeViewAutomationPeer> and <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> classes inherit from <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer> instead of <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer>.</span></span> | <span data-ttu-id="028db-681"><xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> クラスから継承し、<xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer.GetChildrenCore%2A> メソッドをオーバーライドする場合は、新しい <xref:System.Windows.Automation.Peers.TreeViewDataItemAutomationPeer> クラスから継承するオブジェクトを返すことを検討します。</span><span class="sxs-lookup"><span data-stu-id="028db-681">If you inherit from the <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> classes and override the <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer.GetChildrenCore%2A> method, consider returning an object that inherits from the new <xref:System.Windows.Automation.Peers.TreeViewDataItemAutomationPeer> class.</span></span> |
| <span data-ttu-id="028db-682">**コンテナー オフ スクリーン**</span><span class="sxs-lookup"><span data-stu-id="028db-682">**Containers off screen**</span></span> | <span data-ttu-id="028db-683">正しくない戻り値を修正するために、<xref:System.Windows.Automation.Peers.UIElementAutomationPeer.IsOffscreenCore%2A> メソッドは、ビューのスクロールの範囲外にある項目コンテナーについて、`false` を正しく返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-683">To fix an incorrect return value, the <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.IsOffscreenCore%2A> method now correctly returns `false` for item containers that are scrolled out of view.</span></span> <span data-ttu-id="028db-684">このメソッドの値は、他のウィンドウを閉じても変化しません。また、要素が特定のモニターに表示されるかどうかに影響されません。</span><span class="sxs-lookup"><span data-stu-id="028db-684">Also, the value of the method is not affected by occlusion by other windows, or by whether the element is visible on a specific monitor.</span></span> | <span data-ttu-id="028db-685">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-685">None.</span></span> |
| <span data-ttu-id="028db-686">**メニューと子オブジェクト**</span><span class="sxs-lookup"><span data-stu-id="028db-686">**Menus and child objects**</span></span> | <span data-ttu-id="028db-687"><xref:System.Windows.Controls.MenuItem> オブジェクト以外の子を含むメニューの UI オートメーションを有効にするために、<xref:System.Windows.Automation.Peers.MenuItemAutomationPeer.GetChildrenCore%2A> メソッドは、<xref:System.Windows.Automation.Peers.MenuItemAutomationPeer> オブジェクトではなく、子 <xref:System.Windows.UIElement> オブジェクトの <xref:System.Windows.Automation.Peers.AutomationPeer> オブジェクトを返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-687">To enable UI automation of menus that contain children other than <xref:System.Windows.Controls.MenuItem> objects, the <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer.GetChildrenCore%2A> method now returns the <xref:System.Windows.Automation.Peers.AutomationPeer> object of a child <xref:System.Windows.UIElement> object, instead of a <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer> object.</span></span> | <span data-ttu-id="028db-688">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-688">None.</span></span> |
| <span data-ttu-id="028db-689">**新しいインターフェイスとアセンブリ**</span><span class="sxs-lookup"><span data-stu-id="028db-689">**New interfaces and assembly**</span></span> | <span data-ttu-id="028db-690">UI オートメーションの新機能を有効にするために、次のインターフェイスが追加されました。</span><span class="sxs-lookup"><span data-stu-id="028db-690">To enable new features for UI automation, the following interfaces were added:</span></span><br><br>* <xref:System.Windows.Automation.Provider.IItemContainerProvider><br>* <xref:System.Windows.Automation.Provider.ISynchronizedInputProvider><br>* <xref:System.Windows.Automation.Provider.IVirtualizedItemProvider> | <span data-ttu-id="028db-691">WPF オートメーション ピアを構築するプロジェクトでは、UIAutomationProvider.dll への明示的な参照を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="028db-691">Any project that builds WPF automation peers must add an explicit reference to UIAutomationProvider.dll.</span></span> |
| <span data-ttu-id="028db-692">**Thumb**</span><span class="sxs-lookup"><span data-stu-id="028db-692">**Thumbs**</span></span> | <span data-ttu-id="028db-693"><xref:System.Windows.Automation.Peers.ThumbAutomationPeer.GetClassNameCore%2A> メソッドは、null の代わりに値を返します。</span><span class="sxs-lookup"><span data-stu-id="028db-693">The <xref:System.Windows.Automation.Peers.ThumbAutomationPeer.GetClassNameCore%2A> method returns a value instead of null.</span></span> <span data-ttu-id="028db-694">このため、<xref:System.Windows.Controls.GridSplitter> などの、<xref:System.Windows.Controls.Primitives.Thumb> クラスから継承されたコントロールでは、UI オートメーションに名前を報告します。</span><span class="sxs-lookup"><span data-stu-id="028db-694">Therefore, controls such as <xref:System.Windows.Controls.GridSplitter> that inherit from the <xref:System.Windows.Controls.Primitives.Thumb> class will report a name to UI Automation.</span></span> | <span data-ttu-id="028db-695">なし。</span><span class="sxs-lookup"><span data-stu-id="028db-695">None.</span></span> |
| <span data-ttu-id="028db-696">**仮想化された要素**</span><span class="sxs-lookup"><span data-stu-id="028db-696">**Virtualized elements**</span></span> | <span data-ttu-id="028db-697">パフォーマンスを向上させるために、<xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A> メソッドは、すべての子オブジェクトではなく、ビジュアル ツリーに存在する子オブジェクトのみを返します (オブジェクトが仮想化されているかどうかは関係ありません)。</span><span class="sxs-lookup"><span data-stu-id="028db-697">To improve performance, the <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A> method returns only the child objects that are actually in the visual tree, instead of all child objects, regardless of whether they are virtualized.</span></span> | <span data-ttu-id="028db-698"><xref:System.Windows.Automation.ItemContainerPattern> を使用して <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer> のすべての項目を反復処理します。</span><span class="sxs-lookup"><span data-stu-id="028db-698">Use <xref:System.Windows.Automation.ItemContainerPattern> to iterate over all items of an <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer>.</span></span> |

### <a name="xaml"></a><span data-ttu-id="028db-699">XAML</span><span class="sxs-lookup"><span data-stu-id="028db-699">XAML</span></span>

<span data-ttu-id="028db-700">名前空間: <xref:System.Windows>、<xref:System.Windows.Controls>、<xref:System.Windows.Data>、<xref:System.Windows.Input>、<xref:System.Windows.Markup>。アセンブリ: PresentationFramework (PresentationFramework.dll 内)、PresentationCore (PresentationCore.dll 内)、WindowsBase (WindowsBase.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-700">Namespaces: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>, <xref:System.Windows.Markup>; assemblies: PresentationFramework (in PresentationFramework.dll), PresentationCore (in PresentationCore.dll), WindowsBase (in WindowsBase.dll)</span></span>

| <span data-ttu-id="028db-701">機能</span><span class="sxs-lookup"><span data-stu-id="028db-701">Feature</span></span> | <span data-ttu-id="028db-702">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-702">Differences from 3.5 SP1</span></span> | <span data-ttu-id="028db-703">推奨される変更</span><span class="sxs-lookup"><span data-stu-id="028db-703">Recommended changes</span></span> |
| ------- | ------------------------ | ------------------- |
| <span data-ttu-id="028db-704">**マークアップ拡張機能**</span><span class="sxs-lookup"><span data-stu-id="028db-704">**Markup extension**</span></span> | <span data-ttu-id="028db-705">WPF でマークアップ拡張機能を使用するときは、状況に応じて <xref:System.Windows.Markup.MarkupExtension> オブジェクトを返す代わりに、常に <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> メソッドの値を正確に使用して、プロパティの設定またはコレクションの項目作成を行うようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-705">WPF now correctly always uses the value from the <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> method instead of returning the <xref:System.Windows.Markup.MarkupExtension> object in certain cases when a markup extension is used to set a property or to create an item in a collection.</span></span> <span data-ttu-id="028db-706">マークアップ拡張機能は、状況によっては自身の値を返すことがあります。</span><span class="sxs-lookup"><span data-stu-id="028db-706">A markup extension might return itself in some cases.</span></span> | <span data-ttu-id="028db-707">旧バージョンの <xref:System.Windows.Markup.MarkupExtension> オブジェクトを返すリソースにアクセスするアプリケーションの場合は、<xref:System.Windows.Markup.MarkupExtension> オブジェクトではなく、<xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> から返されるオブジェクトを参照します。</span><span class="sxs-lookup"><span data-stu-id="028db-707">If your application accesses a resource that returned a <xref:System.Windows.Markup.MarkupExtension> object in earlier versions, reference the object that is returned from <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A>, instead of the <xref:System.Windows.Markup.MarkupExtension> object.</span></span> |
| <span data-ttu-id="028db-708">**属性の解析**</span><span class="sxs-lookup"><span data-stu-id="028db-708">**Parsing attributes**</span></span> | <span data-ttu-id="028db-709">XAML の属性は 1 つのピリオドのみを持つことができるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-709">Attributes in XAML can now have only one period.</span></span> <span data-ttu-id="028db-710">たとえば、次の例は有効です。</span><span class="sxs-lookup"><span data-stu-id="028db-710">For example, the following are valid:</span></span><br><br><span data-ttu-id="028db-711">`<Button Background="Red"/>` (ピリオドなし)</span><span class="sxs-lookup"><span data-stu-id="028db-711">`<Button Background="Red"/>` (no periods)</span></span><br><br><span data-ttu-id="028db-712">`<Button Button.Background = "Red"/>` (1 つのピリオド)</span><span class="sxs-lookup"><span data-stu-id="028db-712">`<Button Button.Background = "Red"/>` (one period)</span></span><br><br><span data-ttu-id="028db-713">次の例は無効です。</span><span class="sxs-lookup"><span data-stu-id="028db-713">The following is no longer valid:</span></span><br><br><span data-ttu-id="028db-714">`<Button Control.Button.Background = "Red"/>` (複数のピリオド)</span><span class="sxs-lookup"><span data-stu-id="028db-714">`<Button Control.Button.Background = "Red"/>` (more than one period)</span></span> | <span data-ttu-id="028db-715">複数のピリオドを持つ XAML 属性を修正します。</span><span class="sxs-lookup"><span data-stu-id="028db-715">Correct XAML attributes that have more than one period.</span></span> |

## <a name="xml"></a><span data-ttu-id="028db-716">XML</span><span class="sxs-lookup"><span data-stu-id="028db-716">XML</span></span>

<span data-ttu-id="028db-717">次の表に、以前は制限やその他の問題があった機能に対する改善点を示します。</span><span class="sxs-lookup"><span data-stu-id="028db-717">The rows in this table describe improvements to features that previously had limitations or other issues.</span></span>

### <a name="schema-and-transforms"></a><span data-ttu-id="028db-718">スキーマと変換</span><span class="sxs-lookup"><span data-stu-id="028db-718">Schema and transforms</span></span>

<span data-ttu-id="028db-719">名前空間: <xref:System.Xml.Linq>、<xref:System.Xml.Schema>、<xref:System.Xml.XPath>。アセンブリ: System.Xml (System.Xml.dll 内)、System.Xml.Linq (System.Xml.Linq.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-719">Namespaces: <xref:System.Xml.Linq>; <xref:System.Xml.Schema>, <xref:System.Xml.XPath>; assemblies: System.Xml (in System.Xml.dll), System.Xml.Linq (in System.Xml.Linq.dll)</span></span>

| <span data-ttu-id="028db-720">機能</span><span class="sxs-lookup"><span data-stu-id="028db-720">Feature</span></span> | <span data-ttu-id="028db-721">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-721">Differences from 3.5 SP1</span></span> |
| ------- | ------------------------ |
| <span data-ttu-id="028db-722">**カメレオン スキーマ**</span><span class="sxs-lookup"><span data-stu-id="028db-722">**Chameleon schemas**</span></span> | <span data-ttu-id="028db-723">データの破損を防ぐために、カメレオン スキーマは、複数のスキーマにインクルードされている場合に、正しく複製されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-723">To prevent data corruption, chameleon schemas are now cloned correctly when they are included with multiple schemas.</span></span><br><br><span data-ttu-id="028db-724">カメレオン スキーマは、ターゲット名前空間を持たないスキーマであり、別の XSD にインクルードされている場合は、インポート スキーマのターゲット名前空間を引き継ぎます。</span><span class="sxs-lookup"><span data-stu-id="028db-724">Chameleon schemas are schemas that do not have a target namespace, and when they are included in another XSD, they take on the target namespace of the importing schema.</span></span> <span data-ttu-id="028db-725">これらは、スキーマに共通の型をインクルードするためによく使用されます。</span><span class="sxs-lookup"><span data-stu-id="028db-725">They are often used to include common types into a schema.</span></span> |
| <span data-ttu-id="028db-726">**ID 関数**</span><span class="sxs-lookup"><span data-stu-id="028db-726">**ID functions**</span></span> | <span data-ttu-id="028db-727">XSLT [id 関数](/sql/xquery/functions-on-sequences-id)は、<xref:System.Xml.XmlReader> オブジェクトが XLST に渡される場合に、null ではなく適切な値を返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-727">The XSLT [id function](/sql/xquery/functions-on-sequences-id) now returns the correct value instead of null when an <xref:System.Xml.XmlReader> object is passed to an XLST.</span></span><br><br><span data-ttu-id="028db-728">ユーザーが <xref:System.Xml.Linq.XNode.CreateReader%2A> メソッドを使用して LINQ to XML クラスから <xref:System.Xml.XmlReader> オブジェクトを作成し、この <xref:System.Xml.XmlReader> オブジェクトが XSLT に渡された場合、XSLT の `id` 関数のインスタンスは以前は null を返しました。</span><span class="sxs-lookup"><span data-stu-id="028db-728">If the user created an <xref:System.Xml.XmlReader> object from a LINQ to XML class by using the <xref:System.Xml.Linq.XNode.CreateReader%2A> method, and this <xref:System.Xml.XmlReader> object was passed to an XSLT, any instances of the `id` function in the XSLT previously returned null.</span></span> <span data-ttu-id="028db-729">これは、`id` 関数に対して許容される戻り値ではありません。</span><span class="sxs-lookup"><span data-stu-id="028db-729">This is not an allowed return value for the `id` function.</span></span> |
| <span data-ttu-id="028db-730">**Namespace 属性**</span><span class="sxs-lookup"><span data-stu-id="028db-730">**Namespace attribute**</span></span> | <span data-ttu-id="028db-731">データの破損を防ぐために、<xref:System.Xml.XPath.XPathNavigator> オブジェクトは `x:xmlns` 属性のローカル名を正しく返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-731">To prevent data corruption, an <xref:System.Xml.XPath.XPathNavigator> object now returns the local name of the `x:xmlns` attribute correctly.</span></span> |
| <span data-ttu-id="028db-732">**名前空間の宣言**</span><span class="sxs-lookup"><span data-stu-id="028db-732">**Namespace declarations**</span></span> | <span data-ttu-id="028db-733">サブツリーの <xref:System.Xml.XmlReader> オブジェクトは、1 つの XML 要素内に重複する名前空間宣言を作成しなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-733">An <xref:System.Xml.XmlReader> object on a sub-tree no longer creates duplicate namespace declarations within one XML element.</span></span> |
| <span data-ttu-id="028db-734">**スキーマの検証**</span><span class="sxs-lookup"><span data-stu-id="028db-734">**Schema validation**</span></span> | <span data-ttu-id="028db-735">誤ったスキーマ検証を防ぐために、<xref:System.Xml.Schema.XmlSchemaSet> クラスは、XSD スキーマが正しく一貫してコンパイルされるようにします。</span><span class="sxs-lookup"><span data-stu-id="028db-735">To prevent erroneous schema validation, the <xref:System.Xml.Schema.XmlSchemaSet> class allows for XSD schemas to be compiled correctly and consistently.</span></span> <span data-ttu-id="028db-736">これらのスキーマには、他のスキーマを含めることができます。たとえば、`A.xsd` は `B.xsd` を含むことができ、さらにその中には `C.xsd` を含むことができます。</span><span class="sxs-lookup"><span data-stu-id="028db-736">These schemas can include other schemas; for example, `A.xsd` can include `B.xsd`, which can include `C.xsd`.</span></span> <span data-ttu-id="028db-737">これらのいずれかをコンパイルすると、この依存関係のグラフがスキャンされます。</span><span class="sxs-lookup"><span data-stu-id="028db-737">Compiling any one of these causes this graph of dependencies to be traversed.</span></span> |
| <span data-ttu-id="028db-738">**スクリプト関数**</span><span class="sxs-lookup"><span data-stu-id="028db-738">**Script functions**</span></span> | <span data-ttu-id="028db-739">[function-available 関数](https://msdn.microsoft.com/library/ms256124(v=vs.110).aspx)は、関数が実際に使用可能な場合に `false` を間違って返さなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-739">The [function-available function](https://msdn.microsoft.com/library/ms256124(v=vs.110).aspx) no longer incorrectly returns `false` when the function is actually available.</span></span> |
| <span data-ttu-id="028db-740">**URI**</span><span class="sxs-lookup"><span data-stu-id="028db-740">**URIs**</span></span> | <span data-ttu-id="028db-741"><xref:System.Xml.Linq.XElement.Load%2A> メソッドは、LINQ クエリで正しい BaseURI を返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="028db-741">The <xref:System.Xml.Linq.XElement.Load%2A> method now returns the correct BaseURI in LINQ queries.</span></span> |

### <a name="validation"></a><span data-ttu-id="028db-742">検証</span><span class="sxs-lookup"><span data-stu-id="028db-742">Validation</span></span>

<span data-ttu-id="028db-743">名前空間: <xref:System.Xml.Linq>、<xref:System.Xml.Schema>、<xref:System.Xml.XPath>。アセンブリ: System.Xml (System.Xml.dll 内)、System.Xml.Linq (System.Xml.Linq.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-743">Namespaces: <xref:System.Xml.Linq>; <xref:System.Xml.Schema>, <xref:System.Xml.XPath>; assemblies: System.Xml (in System.Xml.dll), System.Xml.Linq (in System.Xml.Linq.dll)</span></span>

| <span data-ttu-id="028db-744">機能</span><span class="sxs-lookup"><span data-stu-id="028db-744">Feature</span></span> | <span data-ttu-id="028db-745">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-745">Differences from 3.5 SP1</span></span> |
| ------- | ------------------------ |
| <span data-ttu-id="028db-746">**名前空間リゾルバー**</span><span class="sxs-lookup"><span data-stu-id="028db-746">**Namespace resolvers**</span></span> | <span data-ttu-id="028db-747"><xref:System.Xml.XmlReader.ReadContentAs%2A> メソッドは、渡された <xref:System.Xml.IXmlNamespaceResolver> リゾルバーを無視しなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-747">The <xref:System.Xml.XmlReader.ReadContentAs%2A> method no longer ignores the <xref:System.Xml.IXmlNamespaceResolver> resolver passed to it.</span></span><br><br><span data-ttu-id="028db-748">以前のバージョンでは、指定した名前空間リゾルバーが無視され、<xref:System.Xml.XmlReader> が代わりに使用されました。</span><span class="sxs-lookup"><span data-stu-id="028db-748">In previous versions, the specified namespace resolver was ignored, and the <xref:System.Xml.XmlReader> was used instead.</span></span> |
| <span data-ttu-id="028db-749">**空白**</span><span class="sxs-lookup"><span data-stu-id="028db-749">**White space**</span></span> | <span data-ttu-id="028db-750">リーダーを作成するときのデータの消失を防ぐために、<xref:System.Xml.XmlReader.Create%2A> メソッドは有意の空白を破棄しなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-750">To prevent data loss when you are creating a reader, the <xref:System.Xml.XmlReader.Create%2A> method no longer discards significant white space.</span></span><br><br><span data-ttu-id="028db-751">XML 検証では、テキストを XML マークアップと混合できる混合コンテンツ モードが認識されます。</span><span class="sxs-lookup"><span data-stu-id="028db-751">XML validation recognizes mixed-content mode, where text can be intermixed with XML markup.</span></span> <span data-ttu-id="028db-752">混合モードでは、すべての空白が有意であり、報告される必要があります。</span><span class="sxs-lookup"><span data-stu-id="028db-752">In mixed mode, all white space is significant and should be reported.</span></span> |

### <a name="writing"></a><span data-ttu-id="028db-753">書き込み</span><span class="sxs-lookup"><span data-stu-id="028db-753">Writing</span></span>

<span data-ttu-id="028db-754">名前空間: <xref:System.Xml.Linq>、<xref:System.Xml.Schema>、<xref:System.Xml.XPath>。アセンブリ: System.Xml (System.Xml.dll 内)、System.Xml.Linq (System.Xml.Linq.dll 内)</span><span class="sxs-lookup"><span data-stu-id="028db-754">Namespaces: <xref:System.Xml.Linq>; <xref:System.Xml.Schema>, <xref:System.Xml.XPath>; assemblies: System.Xml (in System.Xml.dll), System.Xml.Linq (in System.Xml.Linq.dll)</span></span>

| <span data-ttu-id="028db-755">機能</span><span class="sxs-lookup"><span data-stu-id="028db-755">Feature</span></span> | <span data-ttu-id="028db-756">3.5 SP1 との相違</span><span class="sxs-lookup"><span data-stu-id="028db-756">Differences from 3.5 SP1</span></span> |
| ------- | ------------------------ |
| <span data-ttu-id="028db-757">**エンティティ参照**</span><span class="sxs-lookup"><span data-stu-id="028db-757">**Entity references**</span></span> | <span data-ttu-id="028db-758">データの破損を防ぐために、エンティティ参照は XML 属性を 2 回エンティティ化しなくなりました。</span><span class="sxs-lookup"><span data-stu-id="028db-758">To prevent data corruption, entity references are no longer entitized twice in XML attributes.</span></span><br><br><span data-ttu-id="028db-759">ユーザーがエンティティを `xmlns` 属性に書き込もうとするか、または <xref:System.Xml.XmlWriter.WriteEntityRef%2A> メソッドを使用して `xml:lang` 属性または `xml:space` 属性に書き込もうとした場合、エンティティは出力に 2 回エンティティ化されるため、データが破損します。</span><span class="sxs-lookup"><span data-stu-id="028db-759">If the user tried to write an entity into an `xmlns` attribute or into an `xml:lang` or `xml:space` attribute by using the <xref:System.Xml.XmlWriter.WriteEntityRef%2A> method, the entity was entitized twice in the output, therefore corrupting the data.</span></span> |
| <span data-ttu-id="028db-760">**改行処理**</span><span class="sxs-lookup"><span data-stu-id="028db-760">**New line handling**</span></span> | <span data-ttu-id="028db-761">データの破損を防ぐために、<xref:System.Xml.XmlWriter> オブジェクトは <xref:System.Xml.NewLineHandling> オプションを考慮します。</span><span class="sxs-lookup"><span data-stu-id="028db-761">To prevent data corruption, <xref:System.Xml.XmlWriter> objects respect the <xref:System.Xml.NewLineHandling> option.</span></span> |

## <a name="see-also"></a><span data-ttu-id="028db-762">関連項目</span><span class="sxs-lookup"><span data-stu-id="028db-762">See also</span></span>

### <a name="reference"></a><span data-ttu-id="028db-763">参照</span><span class="sxs-lookup"><span data-stu-id="028db-763">Reference</span></span>

- [<span data-ttu-id="028db-764">.NET Framework 4 における新しい型とメンバー</span><span class="sxs-lookup"><span data-stu-id="028db-764">New Types and Members in the .NET Framework 4</span></span>](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff641764%28v=vs.100%29)

### <a name="concepts"></a><span data-ttu-id="028db-765">概念</span><span class="sxs-lookup"><span data-stu-id="028db-765">Concepts</span></span>

- [<span data-ttu-id="028db-766">.NET Framework 4 移行ガイド</span><span class="sxs-lookup"><span data-stu-id="028db-766">Migration Guide to the .NET Framework 4</span></span>](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff657133%28v=vs.100%29)
- [<span data-ttu-id="028db-767">.NET Framework 4 の新機能</span><span class="sxs-lookup"><span data-stu-id="028db-767">What's New in the .NET Framework 4</span></span>](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms171868%28v=vs.100%29)
- [<span data-ttu-id="028db-768">.NET Framework のバージョンの互換性</span><span class="sxs-lookup"><span data-stu-id="028db-768">Version Compatibility in the .NET Framework</span></span>](../../../docs/framework/migration-guide/version-compatibility.md)
- [<span data-ttu-id="028db-769">.NET Framework 4 への Office ソリューションの移行</span><span class="sxs-lookup"><span data-stu-id="028db-769">Migrating Office Solutions to the .NET Framework 4</span></span>](/visualstudio/vsto/migrating-office-solutions-to-the-dotnet-framework-4-or-later)

### <a name="other-resources"></a><span data-ttu-id="028db-770">その他のリソース</span><span class="sxs-lookup"><span data-stu-id="028db-770">Other resources</span></span>

- [<span data-ttu-id="028db-771">.NET Framework クラス ライブラリの互換性のために残されている機能</span><span class="sxs-lookup"><span data-stu-id="028db-771">What's Obsolete in the .NET Framework Class Library</span></span>](../whats-new/whats-obsolete.md)
